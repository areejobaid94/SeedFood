<div [@routerTransition]>
    <div class="header-navbar-shadow"
     ></div>
    <div class="content-wrapper container-xxl p-0">
        <div class="content-body">
            <div class=" d-flex flex-column flex-column-fluid">
                <sub-header *ngIf="theme != 'theme12'" [title]="'quickAnswers' | localize"
                    [description]="'Quick Answer Messages Info' | localize">
                    <div role="actions">
                        <!-- <button (click)="exportToExcel()" class="btn btn-outline-success"><i class="fa fa-file-excel"></i> {{l("ExportToExcel")}}</button> -->

                        <button *ngIf="isGranted('Pages.Administration.TemplateMessages.Create')"
                            (click)="createTemplateMessage()"
                            class="btn btn-primary btn-round btn-sm waves-effect waves-float waves-light"><i
                                class="fa fa-plus"></i> {{l("addQuickAnswer")}}</button>
                    </div>
                </sub-header>
                <sub-header *ngIf="theme === 'theme12'" [title]="'quickAnswers' | localize"
                    [description]="'quickAnswersHeaderInfo' | localize"> </sub-header>

                <div [ngClass]="theme != 'theme12' ? 'container' : ''">
                    <div class=" card-custom gutter-b card"
                      >
                        <div class="card-body">
                            <form *ngIf="theme != 'theme12'" class="form" autocomplete="off">
                                <div class="p-3 row">
                                    <div class="col-md-6 col-12">
                                  
                                    <div class=" d-flex justify-content-md-end">

                                        <div class="input-group">
                                            <input [(ngModel)]="filterText" name="filterText" autoFocus
                                                class="form-control m-input" [placeholder]="l('SearchWithThreeDot')"
                                                type="text">
                                            <span class="input-group-btn">
                                                <button (click)="getTemplateMessages()" class="btn btn-primary"
                                                    type="submit"><i class="flaticon-search-1"></i></button>
                                            </span>
                                        </div>


                                    </div>
                                    <div class="  ">
                                        <div [hidden]="!advancedFiltersAreShown">
                                                <div class="form-group mb-0 mt-1">
                                                    <label
                                                        for="TemplateMessageNameFilter">{{l("TemplateMessageName")}}</label>
                                                    <input type="text" class="form-control"
                                                        id="TemplateMessageNameFilter" name="templateMessageNameFilter"
                                                        [(ngModel)]="templateMessageNameFilter">
                                                </div>
                                        
                                                <div class="form-group mb-0 mt-1">
                                                    <label
                                                        for="MinMessageCreationDateFilter">{{l("MessageCreationDateRange")}}</label>
                                                    <div class="input-group">
                                                        <input class="form-control m-input"
                                                            id="MinMessageCreationDateFilter"
                                                            name="MinMessageCreationDateFilter" type="datetime"
                                                            bsDatepicker placeholder="{{l('MinValue')}}"
                                                            [(ngModel)]="minMessageCreationDateFilter">
                                                        <span style="line-height: 40px;padding: 0 15px 0 15px;"> &mdash;
                                                        </span>
                                                        <input class="form-control m-input"
                                                            id="MaxMessageCreationDateFilter"
                                                            name="MaxMessageCreationDateFilter" type="datetime"
                                                            bsDatepicker placeholder="{{l('MaxValue')}}"
                                                            [(ngModel)]="maxMessageCreationDateFilter">
                                                    </div>
                                                </div>
                                         
                                            <!-- <div class="col-md-3">
                                  <div class="form-group">
                                      <label for="TemplateMessagePurposePurposeFilter">({{l("TemplateMessagePurpose")}}) {{l("Purpose")}}</label>
                                      <input type="text" class="form-control" id="TemplateMessagePurposePurposeFilter" name="templateMessagePurposePurposeFilter" [(ngModel)]="templateMessagePurposePurposeFilter">
                                  </div>
                              </div> -->

                                        </div>

                                        <div class="row mb-2">

                                            <span class="clickable-item text-muted" *ngIf="!advancedFiltersAreShown"
                                                (click)="advancedFiltersAreShown=!advancedFiltersAreShown"><i
                                                    class="fa fa-angle-down"></i> {{l("ShowAdvancedFilters")}}</span>
                                            <span class="clickable-item text-muted" *ngIf="advancedFiltersAreShown"
                                                (click)="advancedFiltersAreShown=!advancedFiltersAreShown"><i
                                                    class="fa fa-angle-up"></i> {{l("HideAdvancedFilters")}}</span>

                                        </div>
                                    </div>
                                    </div>
                                </div>
                            </form>
                            <div class="row mb-2" *ngIf="theme === 'theme12'">
                                <div class="col-md-6 col-12">
                                    <div class="d-flex ml-1 align-items-center pr-1 pb-1 pl-1 pl-md-0 pb-md-0">
                                        <form class="form w-100" autocomplete="off">
                                            <div class="row">
                                                    <div class="row">

                                                        <div class="form-group m-form__group align-items-center">
                                                            <div class="d-flex">
                                                                <input [(ngModel)]="filterText" name="filterText"
                                                                    class=" m-input form-control"
                                                                    [placeholder]="l('SearchWithThreeDot')"
                                                                    type="text">

                                                                <button (click)="getTemplateMessages()"
                                                                    class="btn btn-primary-info" type="submit"><i
                                                                        class="flaticon-search-1"></i></button>

                                                            </div>
                                                        </div>

                                                    </div>
                                                    <div class="row" [hidden]="!advancedFiltersAreShown">
                                                            <div class="form-group   m-form__group align-items-center mt-1">
                                                                <label
                                                                    for="TemplateMessageNameFilter">{{l("TemplateMessageName")}}</label>
                                                                <input type="text"
                                                                class="form-control"
                                                                    id="TemplateMessageNameFilter"
                                                                    name="templateMessageNameFilter"
                                                                    [(ngModel)]="templateMessageNameFilter">
                                                            </div>
                                                        <div class="row">
                                                            <div class="form-group p-0 mt-1">
                                                                <label
                                                                    for="MinMessageCreationDateFilter">{{l("MessageCreationDateRange")}}</label>
                                                                <div class="input-group">
                                                                    <input
                                                                      
                                                                        class=" m-input form-control"
                                                                        id="MinMessageCreationDateFilter"
                                                                        name="MinMessageCreationDateFilter"
                                                                        type="datetime" bsDatepicker
                                                                        placeholder="{{l('MinValue')}}"
                                                                        [(ngModel)]="minMessageCreationDateFilter">
                                                                    <span
                                                                        style="line-height: 40px;padding: 0 15px 0 15px;">
                                                                        &mdash; </span>
                                                                    <input
                                                                        class=" m-input form-control"
                                                                        id="MaxMessageCreationDateFilter"
                                                                        name="MaxMessageCreationDateFilter"
                                                                        type="datetime" bsDatepicker
                                                                        placeholder="{{l('MaxValue')}}"
                                                                        [(ngModel)]="maxMessageCreationDateFilter">
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <!-- <div class="col-md-3">
                                            <div class="form-group">
                                                <label for="TemplateMessagePurposePurposeFilter">({{l("TemplateMessagePurpose")}}) {{l("Purpose")}}</label>
                                                <input type="text" class="form-control" id="TemplateMessagePurposePurposeFilter" name="templateMessagePurposePurposeFilter" [(ngModel)]="templateMessagePurposePurposeFilter">
                                            </div>
                                        </div> -->

                                                    </div>

                                                    <div class="row mt-1">

                                                        <span class="clickable-item text-muted"
                                                            *ngIf="!advancedFiltersAreShown"
                                                            (click)="advancedFiltersAreShown=!advancedFiltersAreShown"><i
                                                                class="fa fa-angle-down"></i>
                                                            {{l("ShowAdvancedFilters")}}</span>
                                                        <span class="clickable-item text-muted"
                                                            *ngIf="advancedFiltersAreShown"
                                                            (click)="advancedFiltersAreShown=!advancedFiltersAreShown"><i
                                                                class="fa fa-angle-up"></i>
                                                            {{l("HideAdvancedFilters")}}</span>

                                                    </div>
                                       

                                            </div>
                                        </form>
                                    </div>
                                </div>
                                <div class="col-md-6 col-12 p-1" [ngClass]="isArabic? 'text-left' : 'text-right'">
                                    <button *ngIf="isGranted('Pages.Administration.TemplateMessages.Create')"
                                        (click)="createTemplateMessage()" class="btn btn-outline-primary-info ">
                                        <i class="fa fa-plus"></i>{{l("addQuickAnswer")}}
                                    </button>
                                </div>
                            </div>

                            

                            <div class=" align-items-center">
                                <!--<Primeng-Datatable-Start>-->
                                <div class="primeng-datatable-container " [busyIf]="primengTableHelper.isLoading">
                                    <p-table #dataTable (onLazyLoad)="getTemplateMessages($event)"
                                        [value]="primengTableHelper.records" rows="20" [paginator]="false" [lazy]="true"
                                        [scrollable]="true" ScrollWidth="100%"
                                        [responsive]="primengTableHelper.isResponsive"
                                        [resizableColumns]="primengTableHelper.resizableColumns">
                                        <ng-template pTemplate="header">
                                            <tr>
                                                <th [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark-table' : ''"
                                                    style="width: 130px"
                                                    [hidden]="!isGrantedAny('Pages.Administration.TemplateMessages.Edit', 'Pages.Administration.TemplateMessages.Delete')">
                                                    {{l('Actions')}}</th>
                                                <!-- <th style="width: 150px" pSortableColumn="templateMessagePurposeFk.purpose">
                                          {{l('Purpose')}}
                                          <p-sortIcon field="templateMessagePurposePurpose"></p-sortIcon>
                                      </th> -->
                                                <th [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark-table' : ''"
                                                    style="width: 150px" pSortableColumn="templateMessageName">
                                                    {{l('TemplateMessageName')}}
                                                    <p-sortIcon
                                                        field="templateMessage.templateMessageName"></p-sortIcon>
                                                </th>
                                                <th [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark-table' : ''"
                                                    style="width: 150px" pSortableColumn="messageCreationDate">
                                                    {{l('MessageCreationDate')}}
                                                    <p-sortIcon
                                                        field="templateMessage.messageCreationDate"></p-sortIcon>
                                                </th>

                                            </tr>
                                        </ng-template>
                                        <ng-template pTemplate="body" let-record="$implicit" let-i="rowIndex">
                                            <tr>
                                                <td [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : ''"
                                                    style="width: 130px"
                                                    [hidden]="!isGrantedAny('Pages.Administration.TemplateMessages.Edit', 'Pages.Administration.TemplateMessages.Delete')">
                                                    <div class="btn-group dropdown" dropdown container="body">
                                                        <button
                                                            [ngClass]="theme != 'theme12' ? 'btn-primary' : 'btn-primary-info'"
                                                            class="dropdown-toggle btn btn-sm " dropdownToggle>
                                                            <i class="fa fa-cog"></i><span class="caret"></span>
                                                        </button>
                                                        <ul [ngClass]="darkModeService.currentSkin === 'dark' ? 'drop-down-dark' : ''"
                                                            class="dropdown-menu" *dropdownMenu>
                                                            <!-- <li>
                                                                <a href="javascript:;" class="dropdown-item"
                                                                    (click)="viewTemplateMessageModal.show(record)">{{l('View')}}</a>
                                                            </li> -->
                                                            <li>
                                                                <a href="javascript:;"
                                                                    *ngIf="permission.isGranted('Pages.Administration.TemplateMessages.Edit')"
                                                                    class="dropdown-item"
                                                                    (click)="createOrEditTemplateMessageModal.show(record.templateMessage.id)">{{l('Edit')}}</a>
                                                            </li>
                                                            <li>
                                                                <a class="dropdown-item" href="javascript:;"
                                                                    *ngIf="permission.isGranted('Pages.Administration.TemplateMessages.Delete')"
                                                                    (click)="deleteTemplateMessage(record.templateMessage)">{{l('Delete')}}</a>
                                                            </li>
                                                            <li>
                                                                <a href="javascript:;" *ngIf="entityHistoryEnabled"
                                                                    class="dropdown-item"
                                                                    (click)="showHistory(record.templateMessage)">{{l('History')}}</a>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </td>
                                                <!-- <td style="width:150px">
                                                  <span class="p-column-title"> {{l('Purpose')}}</span>
                                                  {{record.templateMessagePurposePurpose}}
                                              </td> -->
                                                <td [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : ''"
                                                    style="max-width:170px ">
                                                    <span class="p-column-title"> {{l('TemplateMessageName')}}</span>
                                                    {{record.templateMessage.templateMessageName}}
                                                </td>
                                                <td [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : ''"
                                                    style="width:150px">
                                                    <span class="p-column-title"> {{l('MessageCreationDate')}}</span>
                                                    <span *ngIf="record.templateMessage.messageCreationDate">
                                                        {{record.templateMessage.messageCreationDate | momentFormat:'L'
                                                        }}
                                                    </span>
                                                    <span *ngIf="!record.templateMessage.messageCreationDate">-</span>
                                                </td>

                                            </tr>

                                        </ng-template>
                                    </p-table>
                                    <div class="primeng-no-data" *ngIf="primengTableHelper.totalRecordsCount == 0">
                                        {{l('NoData')}}
                                    </div>
                                    <div class="primeng-paging-container">
                                        <p-paginator [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark' : ''"
                                            [rows]="20" #paginator (onPageChange)="getTemplateMessages($event)"
                                            [totalRecords]="primengTableHelper.totalRecordsCount"
                                            [rowsPerPageOptions]="[10,20,30]">
                                        </p-paginator>
                                        <span class="total-records-count">
                                            {{l('TotalRecordsCount', primengTableHelper.totalRecordsCount)}}
                                        </span>
                                    </div>
                                </div>
                                <!--<Primeng-Datatable-End>-->
                            </div>
                        </div>
                    </div>
                </div>
                <createOrEditTemplateMessageModal #createOrEditTemplateMessageModal (modalSave)="getTemplateMessages()">
                </createOrEditTemplateMessageModal>
                <!-- <viewTemplateMessageModal #viewTemplateMessageModal></viewTemplateMessageModal> -->
                <entityTypeHistoryModal #entityTypeHistoryModal></entityTypeHistoryModal>
            </div>
        </div>
    </div>
</div>