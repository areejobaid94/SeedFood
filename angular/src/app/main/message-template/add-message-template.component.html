<div
    bsModal
    #createOrEditModal="bs-modal"
    class="modal fade"
    tabindex="-1"
    role="dialog"
    aria-labelledby="createOrEditModal"
    aria-hidden="true"
    [config]="{ backdrop: 'static', keyboard: !saving }"
>
    <div *ngIf="!isOptOutMessage && template.category == 'MARKETING' && !optOutButtonFlag && this.firstSaveFlag" style="position: fixed; width: 100%; height: 100vh; background-color: rgb(0 0 0 / 33%); z-index: 2; display: flex; justify-content: center; align-items: center">
        <div style="background-color: white; border-radius: 20px; display: flex; flex-direction: column; align-items: center; width: 472px">
            <img src="../../../assets/images/icons/warning.png" alt="" style="height: 60px; width: auto; margin-top: 10px" />
            <p style="font-weight: bold; text-align: center; font-size: 17px; margin-top: 10px; width: 100%;">We recommend adding the marketing opt-out button:</p>
            <p style="font-size: 13; padding-inline: 16px; width: 100%; text-align: center;">
                Allow customers to request to opt out of all marketing messages. This can help reduce blocks from customers and increase your quality rating.
            </p>
            <p style="font-weight: bold; text-align: center; font-size: 17px; margin-top: 10px;width: 100%; text-align: center;margin-top: 34px;">:نوصي بإضافة زر إلغاء الاشتراك في التسويق
            </p>
            <p style="font-size: 13; padding-inline: 16px;width: 100%; text-align: center;margin-bottom: 37px;">
                اسمح للعملاء بطلب إلغاء الاشتراك في جميع الرسائل التسويقية. يمكن أن يساعد هذا في تقليل الحظر عن العملاء وزيادة تقييم الجودة.            </p>
            <button (click)="onOk()" style="background-color: #009789 !important; color: white; border: 0px; padding-block: 6px; padding-inline: 20px; border-radius: 20px; margin-bottom: 13px">
                Ok
            </button>
        </div>
    </div>
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <form *ngIf="theme != 'theme12'" #templateForm="ngForm">
                <div class="modal-header">
                    <h4 class="modal-title">
                        <span *ngIf="!isEdit">Add New Message Template</span>
                        <span *ngIf="isEdit">Edit Message Template</span>
                    </h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="divider divider-primary">
                            <div class="divider-text">Template Definition</div>
                        </div>
                        <div class="row mb-2">
                            <div class="form-group col-12 mb-1">
                                <label for="category">Template Category *</label>
                                <div id="category" class="form-check" *ngFor="let category of categoryEnum">
                                    <label class="form-check-label" for="category_{{ category.nameEn }}">
                                        <input
                                            [disabled]="isEdit"
                                            class="form-check-input"
                                            id="category_{{ category.nameEn }}"
                                            [value]="category.id"
                                            type="radio"
                                            name="category"
                                            [(ngModel)]="template.category"
                                            required
                                        />
                                        <span *ngIf="!isArabic">
                                            {{ category.nameEn }}
                                        </span>
                                        <span *ngIf="isArabic">
                                            {{ category.nameAr }}
                                        </span>
                                        <br />
                                        <span class="customPlaceholder" *ngIf="!isArabic">{{ category.placeholderEn }}</span>
                                        <span class="customPlaceholder" *ngIf="isArabic">{{ category.placeholderAr }}</span>
                                    </label>
                                </div>
                                <p class="text-danger" *ngIf="submitted && !template.category">{{ l("ThisFieldIsRequired") }}</p>
                            </div>

                            <div class="form-group col-6 mb-1">
                                <label for="templateName">Template Name *</label>
                                <span
                                    data-placement="top"
                                    data-tooltip="Template name must be in english language and without spaces you can separate words by UNDERSCORE (word_word)"
                                >
                                    <i class="fas fa-info-circle"></i>
                                </span>
                                <input
                                    id="templateName"
                                    name="templateName"
                                    [disabled]="isEdit"
                                    type="text"
                                    class="form-control customInput"
                                    [(ngModel)]="template.name"
                                    maxlength="512"
                                    (ngModelChange)="checkTemplateName(template.name)"
                                    required
                                    [class.error]="(submitted && name.invalid) || !isValidName || isUsed"
                                    #name="ngModel"
                                />
                                <p class="text-danger" *ngIf="submitted && name.invalid">{{ l("ThisFieldIsRequired") }}</p>
                                <p class="text-danger" *ngIf="template.name && !isValidName">Invalid Name</p>
                                <p class="text-danger" *ngIf="template.name && isUsed">The Name is Already Used</p>
                            </div>

                            <div class="form-group col-6 mb-1">
                                <label for="language">Template Language *</label>
                                <select
                                    class="form-control"
                                    id="language"
                                    name="language"
                                    [disabled]="isEdit"
                                    [(ngModel)]="template.language"
                                    (ngModelChange)="changeFooter($event)"
                                    required
                                    [class.error]="submitted && tempLang.invalid"
                                    #tempLang="ngModel"
                                >
                                    <option *ngFor="let language of languageEnum" [value]="language.id">{{ language.name }}</option>
                                </select>
                                <p class="text-danger" *ngIf="submitted && tempLang.invalid">{{ l("ThisFieldIsRequired") }}</p>
                            </div>
                        </div>

                        <div class="row">
                            <div class="divider divider-primary">
                                <div class="divider-text">Message Definition</div>
                            </div>
                            <div class="row">
                                <div class="form-group col-12 mb-1">
                                    <label for="headerType">Header Format </label>
                                    <span class="ml-1 badge badge-pill badge-light-dark">Optional</span>
                                    <p>Add a title or chosse which type of media you'll use for this header.</p>

                                    <select
                                        class="form-control"
                                        id="headerType"
                                        name="headerType"
                                        [(ngModel)]="componentHeader.format"
                                        (change)="checkHeaderFormat(componentHeader.format)"
                                        required
                                        #headerFormat="ngModel"
                                    >
                                        <option *ngFor="let header of headerFormatEnum" [value]="header.id">{{ header.name }}</option>
                                    </select>
                                    <p class="text-danger" *ngIf="submitted && headerFormat.invalid">{{ l("ThisFieldIsRequired") }}</p>
                                </div>

                                <div class="col-12 mb-1" *ngIf="headerImageFlag">
                                    <div class="form-group">
                                        <label for="file"
                                            >Header Image * <span data-placement="top" data-tooltip="Header Image Must be JPEG Or PNG"> <i class="fas fa-info-circle"></i> </span
                                        ></label>
                                        <input
                                            #file
                                            type="file"
                                            id="file"
                                            class="form-control"
                                            name="AttachmentId"
                                            accept="image/*"
                                            (change)="handleFileInput($event)"
                                            required
                                            [class.error]="submitted && !fileToUpload"
                                        />

                                        
                                        <div class="row bodyMessage m-1" *ngIf="Template.mediaLink">
                                            <img alt="Message Template" src="{{ Template.mediaLink }}" style="width: 500px; height: 150px" alt="" />
                                        </div>
                                        <p class="text-danger" *ngIf="submitted && !fileToUpload">{{ l("ThisFieldIsRequired") }}</p>
                                    </div>
                                </div>
                                <div class="col-12 mb-1" *ngIf="headerVideoFlag">
                                    <div class="form-group">
                                        <label for="file"
                                            >Header Video *
                                            <span data-placement="top" data-tooltip="Header Video Must Be MP4 With Max Size Of 16MB"> <i class="fas fa-info-circle"></i> </span
                                        ></label>
                                        <input
                                            #file
                                            type="file"
                                            id="file"
                                            class="form-control"
                                            name="AttachmentId"
                                            accept="video/mp4,video/x-m4v,video/*"
                                            (change)="handleFileInput($event)"
                                            required
                                            [class.error]="submitted && !fileToUpload"
                                        />
                                        <div class="row bodyMessage m-1" *ngIf="Template.mediaLink">
                                            <iframe [src]="Template.mediaLink | custom" style="width: 500px; height: 150px" frameborder="0"></iframe>
                                        </div>
                                        <p class="text-danger" *ngIf="submitted && !fileToUpload">{{ l("ThisFieldIsRequired") }}</p>
                                    </div>
                                </div>
                                <div class="col-12 mb-1" *ngIf="headerDocumentFlag">
                                    <div class="form-group">
                                        <label for="file"
                                            >Header Document * <span data-placement="top" data-tooltip="Header Document Must Be PDF File"> <i class="fas fa-info-circle"></i> </span
                                        ></label>
                                        <input
                                            #file
                                            type="file"
                                            id="file"
                                            class="form-control"
                                            name="AttachmentId"
                                            accept=".pdf"
                                            (change)="handleFileInput($event)"
                                            required
                                            [class.error]="submitted && !fileToUpload"
                                        />
                                        <div class="row bodyMessage m-1" *ngIf="Template.mediaLink">
                                            <iframe [src]="Template.mediaLink | custom" style="width: 500px; height: 150px" frameborder="0"></iframe>
                                        </div>
                                        <p class="text-danger" *ngIf="submitted && !fileToUpload">{{ l("ThisFieldIsRequired") }}</p>
                                    </div>
                                </div>
                                <div class="col-12 mb-1" *ngIf="headerTextFlag">
                                    <div class="form-group">
                                        <label for="headerText"
                                            >Header Text *
                                            <span data-placement="top" data-tooltip="Header Text Max Characters =60 characters"> <i class="fas fa-info-circle"></i> </span
                                        ></label>
                                        <input
                                            id="headerText"
                                            name="headerText"
                                            type="text"
                                            class="form-control"
                                            [(ngModel)]="componentHeader.text"
                                            maxlength="60"
                                            required
                                            [class.error]="submitted && headerText.invalid"
                                            #headerText="ngModel"
                                        />
                                        <p class="text-danger" *ngIf="submitted && headerText.invalid">{{ l("ThisFieldIsRequired") }}</p>
                                    </div>
                                </div>
                                <div class="col-12">
                                    <div class="form-group" style="position: relative">
                                        <h4 for="bodyText">{{ l("bodyText") }} *</h4>
                                        <span>Enter the text for your message in the language you've selected. </span>
                                        <!-- <quill-editor
                                          placeholder="Enter the text for your message in the language you've selected."
                                          trackChanges="all" [modules]="modules"
                                          [(ngModel)]="componentBody.text"
                                          maxLength="1024"
                                          [class.error]="submitted && bodyText.invalid"
                                          #bodyText="ngModel"
                                          (onContentChanged)="textChanged($event)"
                                          (onEditorCreated)="onEditorCreated($event)"
                                          >
                                          </quill-editor> -->

                                        <textarea
                                            class="form-control w-100 body-text mt-1"
                                            [(ngModel)]="componentBody.text"
                                            (ngModelChange)="parseDynamicText(componentBody.text)"
                                            maxLength="1024"
                                            [class.error]="submitted && bodyText.invalid"
                                            #bodyText="ngModel"
                                            rows="6"
                                            id="bodyText"
                                            #myTextarea
                                            required
                                        >
                                        </textarea>
                                        <p class="text-danger" *ngIf="submitted && !isTextValid">{{ ("inValidBodyText") }}</p>
                                        <div *ngIf="!isTextValid" class="custom-callout">
                                            <div class="d-flex">
                                                <i class="bi bi-exclamation-triangle-fill"></i>
                                                <div>
                                                    {{ ("templateBodyWarning") }}
                                                    <div class="innerHint">
                                                        <span>example :Hello {{ '{{' + 1 + '}}' }} from InfoSeed World</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <p class="text-danger" *ngIf="submitted && bodyText.invalid">{{ l("ThisFieldIsRequired") }}</p>
                                        <!-- <p class="text-danger" *ngIf="textBodyMesage">{{ l("templateBodyTextLength") }} 1024 {{ l("character") }}</p> -->
                                        <p class="text-danger" *ngIf="check_If_next_To_Each_Other()">The body text contains variable parameters that are next to each other.</p>
                                        <p class="text-danger" *ngIf="check_End_Or_beginnig()">The body text contains variable parameters at the beginning or end.</p>

                                        <div class="placeholder-number">
                                            <div class=" ">
                                                ​
                                                <span class="text-muted" *ngIf="!componentBody.text">0/1024</span>
                                                <span class="text-muted" *ngIf="componentBody.text">{{ componentBody.text.length }}/1024</span>
                                            </div>
                                        </div>
                                        <div class="row mt-1">
                                            <div class="col">
                                                <span class="text-muted p-0"> 1024 {{ l("character") }} </span>
                                            </div>
                                            <div class="col text-right p-0 body-actions">
                                                <i
                                                    ngbPopover="Insert an emoji"
                                                    #CloseEvent="ngbPopover"
                                                    triggers="mouseenter:mouseleave"
                                                    class="mr-1 bi bi-emoji-smile"
                                                    (click)="showEmoji()"
                                                    aria-hidden="true"
                                                ></i>
                                                <div #emojiMart style="display: contents">
                                                    <emoji-mart
                                                        title="Pick your emoji…"
                                                        (emojiClick)="addEmoji($event)"
                                                        emoji="point_up"
                                                        [hidden]="hideEmoji"
                                                        [darkMode]="darkModeService.currentSkin === 'dark'"
                                                    >
                                                    </emoji-mart>
                                                </div>
                                                <i
                                                    class="mr-1 bi bi-type-bold"
                                                    (click)="boldText()"
                                                    ngbPopover="Bold"
                                                    #CloseEvent="ngbPopover"
                                                    triggers="mouseenter:mouseleave"
                                                ></i>
                                                <i
                                                    class="mr-1 bi bi-type-italic"
                                                    (click)="italicText()"
                                                    ngbPopover="Italic"
                                                    #CloseEvent="ngbPopover"
                                                    triggers="mouseenter:mouseleave"
                                                ></i>

                                                <i
                                                    class="bi bi-info-circle"
                                                    ngbPopover="This is text you specify in the API that will be personalized to the customer, such as their name or invoice number."
                                                    #CloseEvent="ngbPopover"
                                                    triggers="mouseenter:mouseleave"
                                                ></i>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mt-1 text-right" style="float: right">
                                        <button (click)="addVariableOne()" class="btn btn-default w-auto p-0" type="button">
                                            <i class="bi bi-plus"></i>
                                            {{ l("addVariables") }}
                                        </button>

                                        <button (click)="deleteVaribale()" class="btn btn-default w-auto p-0" type="button">
                                            <i class="bi bi-dash"></i>
                                            {{ l("deleteVariables") }}
                                        </button>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="form-group">
                                        <div style="display: flex; flex-direction: row">
                                            <label for="footerText">Footer</label>
                                            <p style="color: #b9b9c3; margin-left: 6px">. Optional</p>
                                        </div>
                                        <div style="display: flex">
                                            <input
                                                id="footerText"
                                                name="footerText"
                                                type="text"
                                                class="form-control"
                                                style="position: absolute; padding-right: 53px"
                                                (input)="handleOnChangeText($event)"
                                                value="{{ footer }}"
                                                maxlength="60"
                                            />
                                            <div style="width: 100%; height: 100%; justify-content: flex-end; display: flex; align-items: center; padding: 0.571rem 1rem">
                                                <p style="z-index: 1; color: #b9b9c3; margin: 0px">{{ footer?.length }}/60</p>
                                            </div>
                                        </div>
                                        <!-- here -->
                                    </div>
                                </div>

                                <div class="col-12 mb-1">
                                    <div class="form-group">
                                        <label for="buttonType">Button Type *</label>
                                        <p>
                                            Create buttons that let customers respond to your message or take action.

                                            <select
                                                class="form-control"
                                                id="buttonType"
                                                name="buttonType"
                                                [(ngModel)]="button.type"
                                                (change)="checkButtonType(button.type)"
                                                required
                                                #buttonName="ngModel"
                                            >
                                                <ng-container *ngFor="let button of buttonTypeEnum">
                                                    <ng-container *ngIf="button.id != 'Opt-out'">
                                                        <option [value]="button.id">{{ button.name }}</option>
                                                    </ng-container>
                                                    <ng-container *ngIf="button.id == 'Opt-out' && template.category == 'MARKETING'">
                                                        <option [value]="button.id">{{ button.name }}</option>
                                                    </ng-container>
                                                </ng-container>
                                            </select>
                                        </p>

                                        <p class="text-danger" *ngIf="submitted && buttonName.invalid">{{ l("ThisFieldIsRequired") }}</p>
                                    </div>
                                </div>

                                <div class="col-12 justify-content-between" *ngIf="buttonFlag">
                                    <div class="form-group" *ngIf="textButtonFlag && showFirstButton">
                                        <label for="buttonText">Button Text *</label>
                                        <input
                                            id="buttonText"
                                            name="buttonText"
                                            type="text"
                                            class="form-control customInput"
                                            [(ngModel)]="button.text"
                                            (input)="handleButtonChange($event)"
                                            maxlength="20"
                                            required
                                            #buttonText="ngModel"
                                            [class.error]="submitted && buttonText.invalid"
                                        />
                                        <div class="row text-right">
                                            <span class="text-muted p-0"> 20 {{ l("character") }} </span>
                                        </div>
                                        <p class="text-danger" *ngIf="submitted && buttonText.invalid">{{ l("ThisFieldIsRequired") }}</p>
                                        <div class="row mt-1" *ngIf="!showSecondButton && textButtonFlag && !phoneButtonFlag && !urlButtonFlag">
                                            <div class="col-12">
                                                <button (click)="createButtonTwo()" class="btn btn-primary"><i class="bi bi-plus"></i> Add Another Button</button>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="customDiv form-group p-0 mt-2" *ngIf="textButtonFlag && showSecondButton">
                                        <label for="buttonText">Button Text *</label>
                                        <div class="row d-flex">
                                            <input
                                                id="buttonText"
                                                class="button-text form-control customInput"
                                                name="buttonText"
                                                type="text"
                                                class="form-control"
                                                [(ngModel)]="buttonTwo.text"
                                                maxlength="20"
                                                (input)="handleButton2Change($event)"
                                                #buttonText2="ngModel"
                                                [class.error]="submitted && buttonText2.invalid"
                                                required
                                            />
                                            <div class="row text-right">
                                                <span class="text-muted p-0"> 20 {{ l("character") }} </span>
                                            </div>
                                            <button *ngIf="showSecondButton" (click)="deleteButtonTwo()" class="delete btn btn-default-primary">
                                                <i class="bi bi-x"></i>
                                            </button>
                                        </div>
                                        <p class="text-danger" *ngIf="submitted && buttonText2.invalid">{{ l("ThisFieldIsRequired") }}</p>
                                    </div>

                                    <div class="form-group customDiv" *ngIf="phoneButtonFlag" [formGroup]="phoneForm">
                                        <h4 for="buttonPhone">{{ l("buttonPhone") }} *</h4>
                                        <ngx-intl-tel-input
                                            class="d-contents"
                                            id="countryCode"
                                            [enablePlaceholder]="true"
                                            [searchCountryFlag]="true"
                                            [maxLength]="13"
                                            [selectFirstCountry]="false"
                                            [enableAutoCountrySelect]="true"
                                            [phoneValidation]="true"
                                            [separateDialCode]="false"
                                            [numberFormat]="PhoneNumberFormat.National"
                                            [preferredCountries]="preferredCountries"
                                            [selectedCountryCode]="countryCode"
                                            formControlName="phone"
                                            (change)="checkPhoneNumber()"
                                            required
                                            [class.error]="submitted && !phoneForm.value"
                                        >
                                        </ngx-intl-tel-input>
                                        <p class="text-danger" *ngIf="submitted && !phoneForm.value">{{ l("ThisFieldIsRequired") }}</p>
                                        <p class="text-danger" *ngIf="phoneForm.value && phoneForm.status != 'VALID'">Please Enter Valid Phone Number</p>
                                    </div>

                                    <div class="form-group customDiv" *ngIf="urlButtonFlag">
                                        <label for="buttonUrl">Button Url *</label>
                                        <input
                                            (change)="checkTemplateButtonUrl()"
                                            id="buttonUrl"
                                            name="buttonUrl"
                                            type="text"
                                            class="form-control customInput"
                                            placeholder="https://www.example.com"
                                            [(ngModel)]="button.url"
                                            maxlength="2000"
                                            required
                                            [class.error]="submitted && buttonUrl.invalid"
                                            #buttonUrl="ngModel"
                                        />
                                        <p class="text-danger" *ngIf="submitted && buttonUrl.invalid">{{ l("ThisFieldIsRequired") }}</p>
                                    </div>
                                </div>

                                <!-- Opt-Out-button -->
                                <div class="col-12 justify-content-between" *ngIf="optOutButtonFlag">
                                    <div class="form-group" *ngIf="textButtonFlag && showFirstButton">
                                        <label for="buttonText">Button Text *</label>
                                        <input
                                            id="buttonText"
                                            name="buttonText"
                                            type="text"
                                            class="form-control customInput"
                                            [(ngModel)]="button.text"
                                            maxlength="20"
                                            (input)="handleButtonChange($event)"
                                            required
                                            #buttonText="ngModel"
                                            [class.error]="submitted && buttonText.invalid"
                                        />
                                        <div class="row text-right">
                                            <span class="text-muted p-0"> 20 {{ l("character") }} </span>
                                        </div>
                                        <p class="text-danger" *ngIf="submitted && buttonText.invalid">{{ l("ThisFieldIsRequired") }}</p>
                                        <div class="row mt-1" *ngIf="!showSecondButton && textButtonFlag && !phoneButtonFlag && !urlButtonFlag">
                                            <div class="col-12">
                                                <button (click)="createButtonTwo()" class="btn btn-primary"><i class="bi bi-plus"></i> Add Another Button</button>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="customDiv form-group p-0 mt-2" *ngIf="textButtonFlag && showSecondButton">
                                        <label for="buttonText">Button Text *</label>
                                        <div class="row d-flex">
                                            <input
                                                id="buttonText"
                                                class="button-text form-control customInput"
                                                name="buttonText"
                                                type="text"
                                                class="form-control"
                                                [(ngModel)]="buttonTwo.text"
                                                maxlength="20"
                                                #buttonText2="ngModel"
                                                [class.error]="submitted && buttonText2.invalid"
                                                (input)="handleButton2Change($event)"
                                                required
                                            />
                                            <div class="row text-right">
                                                <span class="text-muted p-0"> 20 {{ l("character") }} </span>
                                            </div>
                                            <button *ngIf="showSecondButton" (click)="deleteButtonTwo()" class="delete btn btn-default-primary">
                                                <i class="bi bi-x"></i>
                                            </button>
                                        </div>
                                        <p class="text-danger" *ngIf="submitted && buttonText2.invalid">{{ l("ThisFieldIsRequired") }}</p>
                                    </div>

                                    <div class="form-group customDiv" *ngIf="phoneButtonFlag" [formGroup]="phoneForm">
                                        <h4 for="buttonPhone">{{ l("buttonPhone") }} *</h4>
                                        <ngx-intl-tel-input
                                            class="d-contents"
                                            id="countryCode"
                                            [enablePlaceholder]="true"
                                            [searchCountryFlag]="true"
                                            [maxLength]="13"
                                            [selectFirstCountry]="false"
                                            [enableAutoCountrySelect]="true"
                                            [phoneValidation]="true"
                                            [separateDialCode]="false"
                                            [numberFormat]="PhoneNumberFormat.National"
                                            [preferredCountries]="preferredCountries"
                                            [selectedCountryCode]="countryCode"
                                            formControlName="phone"
                                            (change)="checkPhoneNumber()"
                                            required
                                            [class.error]="submitted && !phoneForm.value"
                                        >
                                        </ngx-intl-tel-input>
                                        <p class="text-danger" *ngIf="submitted && !phoneForm.value">{{ l("ThisFieldIsRequired") }}</p>
                                        <p class="text-danger" *ngIf="phoneForm.value && phoneForm.status != 'VALID'">Please Enter Valid Phone Number</p>
                                    </div>

                                    <div class="form-group customDiv" *ngIf="urlButtonFlag">
                                        <label for="buttonUrl">Button Url *</label>
                                        <input
                                            (change)="checkTemplateButtonUrl()"
                                            id="buttonUrl"
                                            name="buttonUrl"
                                            type="text"
                                            class="form-control customInput"
                                            placeholder="https://www.example.com"
                                            [(ngModel)]="button.url"
                                            maxlength="2000"
                                            required
                                            [class.error]="submitted && buttonUrl.invalid"
                                            #buttonUrl="ngModel"
                                        />
                                        <p class="text-danger" *ngIf="submitted && buttonUrl.invalid">{{ l("ThisFieldIsRequired") }}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-default" (click)="close()">Cancel</button>
                    <button id="btn" type="button" class="btn btn-primary blue" (click)="save()" [buttonBusy]="saving" [busyText]="l('SavingWithThreeDot')">
                        <i class="fa fa-save"></i>
                        <span>{{ l("Save") }}</span>
                    </button>
                </div>
            </form>
            <div [hidden]="theme != 'theme12'">
                <div class="vertical-wizard">
                    <div class="modal-header">
                        <h4 class="modal-title">
                            <span *ngIf="!isEdit">{{ l("addNewMessageTemplate") }}</span>
                            <span *ngIf="isEdit">{{ l("EditTemplateMessage") }}</span>
                        </h4>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" (click)="close()" aria-label="Close"></button>
                    </div>
                    <div id="stepper2" class="modal-body mb-0 bs-stepper vertical vertical-wizard-example">
                        <div style="display: flex; flex-direction: column; border-right: 1px solid #ebe9f1; border-bottom: none">
                            <div class="bs-stepper-header" style="border-right: none">
                                <div class="step" data-target="#account-details-vertical">
                                    <button type="button" class="step-trigger">
                                        <span class="bs-stepper-box">1</span>
                                        <span class="bs-stepper-label">
                                            <span class="bs-stepper-title">{{ l("templateDefinition") }}</span>
                                        </span>
                                    </button>
                                </div>
                                <div class="step" data-target="#personal-info-vertical">
                                    <button type="button" class="step-trigger" [disabled]="!IsStep2">
                                        <span class="bs-stepper-box">2</span>
                                        <span class="bs-stepper-label">
                                            <span class="bs-stepper-title">{{ l("messageDefintion") }}</span>
                                        </span>
                                    </button>
                                </div>
                                <!-- working here -->
                            </div>

                            <!-- templatePreview -->
                            <div
                                style="
                                    display: flex;
                                    justify-content: center;
                                    align-items: center;
                                    flex-direction: column;
                                    padding-inline: 28px;
                                    margin-top: 20px;
                                    max-width: 370px;
                                "
                            >
                                <div
                                    style="
                                        background-color: gainsboro;
                                        display: flex;
                                        justify-content: center;
                                        align-items: center;
                                        padding-block: 10px;
                                        border-top-right-radius: 20px;
                                        border-top-left-radius: 20px;
                                        width: 100%;
                                    "
                                >
                                    <p style="font-weight: bold; font-size: 12px; margin: 0px">{{ l("templatePreview") }}</p>
                                </div>

                                <div class="row" style="width: 100%; margin-bottom: 20px">
                                    <div class="col-12 col-xl-6" style="width: 100%; padding: 0px">
                                        <div class="m-auto templateCard w-100 p-3" style="border-top-left-radius: 0px; border-top-right-radius: 0px">
                                            <span class="arrow"
                                                ><svg viewBox="0 0 8 13" width="8" height="13" class="">
                                                    <path opacity=".13" fill="#0000000" d="M1.533 3.568 8 12.193V1H2.812C1.042 1 .474 2.156 1.533 3.568z"></path>
                                                    <path fill="currentColor" d="M1.533 2.568 8 11.193V0H2.812C1.042 0 .474 1.156 1.533 2.568z"></path>
                                                </svg>
                                            </span>
                                            <div class="card-body p-2">
                                                <div class="row mb-1" style="max-width: 179px" *ngIf="componentHeader?.text">
                                                    <h2 [ngClass]="{ rtl: Template.language === 'ar' }">
                                                        {{ componentHeader?.text }}
                                                    </h2>
                                                </div>
                                                <div class="row mb-1" *ngIf="headerImageFlag && Template?.mediaLink">
                                                    <img alt="Message Template" class="p-0" src="{{ Template.mediaLink }}" style="height: 150px" alt="Campaign Image" />
                                                </div>
                                                <div class="row mb-1" *ngIf="headerVideoFlag">
                                                    <iframe class="p-0" [src]="Template.mediaLink | custom" frameborder="0"></iframe>
                                                </div>
                                                <div class="row mb-1" *ngIf="headerDocumentFlag">
                                                    <iframe class="p-0" [src]="Template.mediaLink | custom" style="height: 150px" frameborder="0"></iframe>
                                                </div>
                                                <div class="row mb-1">
                                                    <h6 [innerHTML]="formattedTextBody" [ngClass]="{ rtl: Template.language === 'ar' }" class="bodyText"></h6>
                                                </div>
                                            </div>
                                            <div class="card-footer footerCard p-1 pt-0" *ngIf="componentFooter?.text">
                                                <small [ngClass]="{ rtl: Template.language === 'ar' }" style="color: gray">
                                                    {{ componentFooter?.text }}
                                                </small>
                                            </div>
                                            <ng-container *ngIf="isEdit">
                                                <div class="row buttonText" *ngIf="componentButton?.buttons">
                                                    <div class="col p-0" *ngFor="let button of componentButton.buttons">
                                                        <button class="btn btn-light">
                                                            <i *ngIf="urlButtonFlag" class="bi bi-box-arrow-up-right"></i> <i *ngIf="phoneButtonFlag" class="bi bi-telephone-fill"></i> {{ button.text }}
                                                        </button>
                                                    </div>
                                                </div>
                                            </ng-container>
                                            <ng-container *ngIf="!isEdit">
                                                <ng-container *ngFor="let button of componentButtonForView.buttons">
                                                    <div class="row buttonText" *ngIf="componentButtonForView.buttons">
                                                        <div class="col p-0" *ngIf="button.text?.length > 0">
                                                            <button class="btn btn-light">
                                                                <i *ngIf="urlButtonFlag" class="bi bi-box-arrow-up-right"></i> <i *ngIf="phoneButtonFlag" class="bi bi-telephone-fill"></i> {{ button.text }}
                                                            </button>
                                                        </div>
                                                    </div>
                                                </ng-container>
                                            </ng-container>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="bs-stepper-content">
                            <div id="account-details-vertical" class="content">
                                <div class="content-header">
                                    <h3 class="mb-0">{{ l("templateDefinition") }}</h3>
                                </div>

                                <div class="form-group col-12 mb-1">
                                    <h4>{{ l("templateCategory") }} *</h4>
                                    <div id="category" class="mt-2 form-check" *ngFor="let category of categoryEnum; let i = index">
                                        <input
                                            [disabled]="isEdit"
                                            class="form-check-input"
                                            id="category_{{ category.id }}"
                                            [value]="category.id"
                                            type="radio"
                                            name="category"  
                                            [(ngModel)]="template.category"
                                            required
                                        />
                                        <label class="form-check-label" for="category_{{ category.id }}">
                                            <span *ngIf="!isArabic">
                                                {{ category.nameEn }}
                                            </span>
                                            <span *ngIf="isArabic">
                                                {{ category.nameAr }}
                                            </span>
                                            <br />
                                            <h6 class="customPlaceholder" *ngIf="!isArabic">{{ category.placeholderEn }}</h6>
                                            <h6 class="customPlaceholder" *ngIf="isArabic">{{ category.placeholderAr }}</h6>
                                        </label>
                                    </div>
                                    <p class="text-danger" *ngIf="submitted && !template.category">{{ l("ThisFieldIsRequired") }}</p>
                                </div>


                                <div class="form-group col-12 mt-2">
                                    <h4 for="templateName">
                                        {{ l("templateName") }} *

                                        <i class="bi bi-info-circle" [ngbPopover]="'templateNameNote' | localize" #CloseEvent="ngbPopover" triggers="mouseenter:mouseleave"></i>
                                    </h4>

                                    <input
                                        id="templateName"
                                        name="templateName"
                                        [disabled]="isEdit"
                                        type="text"
                                        class="form-control"
                                        [(ngModel)]="template.name"
                                        maxlength="512"
                                        (input)="onTemplateNameChange($event)"
                                        (ngModelChange)="checkTemplateName(template.name)"
                                        required
                                        [class.error]="(submitted && name.invalid) || !isValidName || isUsed"
                                        #name="ngModel"
                                    />

                                    <p class="text-danger" *ngIf="submitted && name.invalid">{{ l("ThisFieldIsRequired") }}</p>
                                    <p class="text-danger" *ngIf="template.name && !isValidName">{{ l("invalidName") }}</p>
                                    <p class="text-danger" *ngIf="template.name && isUsed">{{ l("usedName") }}</p>
                                </div>

                                <div class="form-group col-12 mt-2">
                                    <h4 for="language">{{ l("templateLanguage") }} *</h4>
                                    <select
                                        [ngClass]="darkModeService.currentSkin === 'dark' ? 'form-control-dark ' : 'form-control'"
                                        id="language"
                                        name="language"
                                        [disabled]="isEdit"
                                        #tempLang="ngModel"
                                        [(ngModel)]="template.language"
                                        [class.error]="submitted && tempLang.invalid"
                                        (ngModelChange)="changeFooter($event)"
                                        required
                                    >
                                        <option *ngFor="let language of languageEnum" [value]="language.id">{{ language.name }}</option>
                                    </select>
                                    <p class="text-danger" *ngIf="submitted && tempLang.invalid">{{ l("ThisFieldIsRequired") }}</p>
                                </div>
                                <div class="row mt-2">
                                    <div class="col-6"></div>
                                    <div class="col-6 text-right">
                                        <button class="btn btn-primary-info btn-next" (click)="verticalWizardNext()" rippleEffect>
                                            <span class="align-middle d-sm-inline-block"> {{ l("next") }}</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div id="personal-info-vertical" class="content">
                                <div class="content-header">
                                    <h3 class="mb-0">{{ l("messageDefintion") }}</h3>
                                </div>

                                <div class="row">
                                    <div class="form-group col-12 mt-2 p-0">
                                        <h4 class="d-contents" for="headerType">{{ l("headerFormat") }}</h4>
                                        <span class="ml-1 badge badge-pill badge-light-dark">{{ l("optional") }}</span>
                                        <p>{{ l("templateHeaderNote") }}</p>
                                        <select
                                            class="ww-50"
                                            [ngClass]="darkModeService.currentSkin === 'dark' ? 'form-control-dark ' : 'form-control'"
                                            id="headerType"
                                            name="headerType"
                                            [(ngModel)]="componentHeader.format"
                                            (change)="checkHeaderFormat(componentHeader.format)"
                                            required
                                            #headerFormat="ngModel"
                                        >
                                            <option *ngFor="let header of headerFormatEnum" [value]="header.id">
                                                <span *ngIf="!isArabic">{{ header.nameEn }}</span>
                                                <span *ngIf="isArabic">{{ header.nameAr }}</span>
                                            </option>
                                        </select>
                                        <p class="text-danger" *ngIf="submitted && headerFormat.invalid">{{ l("ThisFieldIsRequired") }}</p>
                                    </div>

                                    <div class="col-12 mt-2 p-0" *ngIf="headerImageFlag">
                                        <div class="form-group">
                                            <h4 for="file">
                                                {{ l("headerImage") }} *

                                                <i
                                                    class="bi bi-info-circle"
                                                    [ngbPopover]="'headerImageNote' | localize"
                                                    #CloseEvent="ngbPopover"
                                                    triggers="mouseenter:mouseleave"
                                                ></i>
                                            </h4>
                                            <input
                                                #file
                                                type="file"
                                                id="file"
                                                class="form-control"
                                                name="AttachmentId"
                                                (change)="handleFileInput($event)"
                                                required
                                                [class.error]="submitted && !fileToUpload"
                                            />
                                            <!-- <div class="row bodyMessage m-1" *ngIf="Template.mediaLink">
                                                <img alt="Message Template" src="{{ Template.mediaLink }}" style="width: 500px; height: 150px" alt="" />
                                            </div> -->
                                            <p class="text-danger" *ngIf="submitted && !fileToUpload">{{ l("ThisFieldIsRequired") }}</p>
                                        </div>
                                    </div>
                                    <div class="col-12 mt-2 p-0" *ngIf="headerVideoFlag">
                                        <div class="form-group">
                                            <h4 for="file">
                                                {{ l("headerVideo") }} *

                                                <i
                                                    class="bi bi-info-circle"
                                                    [ngbPopover]="'headerVideoNote' | localize"
                                                    #CloseEvent="ngbPopover"
                                                    triggers="mouseenter:mouseleave"
                                                ></i>
                                            </h4>
                                            <input
                                                #file
                                                type="file"
                                                id="file"
                                                class="form-control"
                                                name="AttachmentId"
                                                (change)="handleFileInput($event)"
                                                required
                                                [class.error]="submitted && !fileToUpload"
                                            />
                                            <!-- <div class="row bodyMessage m-1" *ngIf="Template.mediaLink">
                                                <iframe [src]="Template.mediaLink | custom" style="width: 500px; height: 150px" frameborder="0"></iframe>
                                            </div> -->
                                            <p class="text-danger" *ngIf="submitted && !fileToUpload">{{ l("ThisFieldIsRequired") }}</p>
                                        </div>
                                    </div>
                                    <div class="col-12 mt-2 p-0" *ngIf="headerDocumentFlag">
                                        <div class="form-group">
                                            <h4 for="file">
                                                {{ l("headerDocument") }} *

                                                <i
                                                    class="bi bi-info-circle"
                                                    [ngbPopover]="'headerDocNote' | localize"
                                                    #CloseEvent="ngbPopover"
                                                    triggers="mouseenter:mouseleave"
                                                ></i>
                                            </h4>
                                            <input
                                                #file
                                                type="file"
                                                id="file"
                                                class="form-control"
                                                name="AttachmentId"
                                                (change)="handleFileInput($event)"
                                                required
                                                [class.error]="submitted && !fileToUpload"
                                            />
                                            <div class="row bodyMessage m-1" *ngIf="Template.mediaLink">
                                                <iframe [src]="Template.mediaLink | custom" style="width: 500px; height: 150px" frameborder="0"></iframe>
                                            </div>
                                            <p class="text-danger" *ngIf="submitted && !fileToUpload">{{ l("ThisFieldIsRequired") }}</p>
                                        </div>
                                    </div>
                                    <div class="col-12 mt-2 p-0" *ngIf="headerTextFlag">
                                        <div class="form-group">
                                            <h4 for="headerText">
                                                {{ l("headerText") }} *
                                                <i
                                                    class="bi bi-info-circle"
                                                    [ngbPopover]="'headerTextNote' | localize"
                                                    #CloseEvent="ngbPopover"
                                                    triggers="mouseenter:mouseleave"
                                                ></i>
                                            </h4>
                                            <input
                                                id="headerText"
                                                name="headerText"
                                                type="text"
                                                class="form-control"
                                                [(ngModel)]="componentHeader.text"
                                                maxlength="60"
                                                required
                                                [class.error]="submitted && headerText.invalid"
                                                #headerText="ngModel"
                                            />
                                            <p class="text-danger" *ngIf="submitted && headerText.invalid">{{ l("ThisFieldIsRequired") }}</p>
                                        </div>
                                    </div>
                                    <div class="col-12 mt-2 p-0">
                                        <div class="form-group" style="position: relative">
                                            <h4 for="bodyText">{{ l("bodyText") }} *</h4>
                                            <span>{{ l("templateBodyDesc") }} </span>
                                            <!-- <quill-editor
                                            placeholder="Enter the text for your message in the language you've selected."
                                            trackChanges="all" [modules]="modules"
                                            [(ngModel)]="componentBody.text"
                                            maxLength="1024"
                                            [class.error]="submitted && bodyText.invalid"
                                            #bodyText="ngModel"
                                            (onContentChanged)="textChanged($event)"
                                            (onEditorCreated)="onEditorCreated($event)"
                                            >
                                            </quill-editor> -->
                                            <span [ngClass]="isArabic ? 'rtl' : ''">
                                                <textarea
                                                    class="form-control w-100 body-text mt-1 padding-top"
                                                    [(ngModel)]="componentBody.text"
                                                    (ngModelChange)="parseDynamicText(componentBody.text)"
                                                    maxLength="1024"
                                                    [class.error]="submitted && bodyText.invalid"
                                                    #bodyText="ngModel"
                                                    rows="6"
                                                    id="bodyText"
                                                    #myTextarea
                                                    required
                                                >
                                                </textarea>
                                                <p class="text-danger" *ngIf="submitted && !isTextValid">{{ l("inValidBodyText") }}</p>
                                            </span>
                                            <div *ngIf="!isTextValid" class="custom-callout">
                                                <div class="d-flex">
                                                    <i class="bi bi-exclamation-triangle-fill"></i>
                                                    <div>
                                                        {{ l("templateBodyWarning") }}
                                                        <div class="innerHint">
                                                            <span>example :Hello {{ '{{' + 1 + '}}' }} from InfoSeed World</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <p class="text-danger" *ngIf="submitted && bodyText.invalid">{{ l("ThisFieldIsRequired") }}</p>
                                            <!-- <p class="text-danger" *ngIf="textBodyMesage">{{ l("templateBodyTextLength") }} 1024 {{ l("character") }}</p> -->
                                            <p class="text-danger" *ngIf="check_If_next_To_Each_Other()">The body text contains variable parameters that are next to each other.</p>
                                            <p class="text-danger" *ngIf="check_End_Or_beginnig()">The body text contains variable parameters at the beginning or end.</p>
                                            <span [ngClass]="isArabic ? 'rtl' : ''">
                                                <div class="placeholder-number">
                                                    <div style="margin-top: 15px">
                                                        <span class="text-muted" *ngIf="!componentBody.text">0/1024</span>
                                                        <span class="text-muted" *ngIf="componentBody.text">{{ componentBody.text.length }}/1024</span>
                                                    </div>
                                                </div>
                                            </span>
                                            <div class="row mt-1">
                                                <div class="col">
                                                    <span class="p-0"> 1024 {{ l("character") }} </span>
                                                </div>
                                                <div class="col text-right p-0 body-actions">
                                                    <i
                                                        [ngbPopover]="'insertEmoji' | localize"
                                                        #CloseEvent="ngbPopover"
                                                        triggers="mouseenter:mouseleave"
                                                        class="mr-1 bi bi-emoji-smile"
                                                        (click)="showEmoji()"
                                                        aria-hidden="true"
                                                    ></i>
                                                    <div #emojiMart style="display: contents">
                                                        <emoji-mart
                                                            title="Pick your emoji…"
                                                            (emojiClick)="addEmoji($event)"
                                                            emoji="point_up"
                                                            [hidden]="hideEmoji"
                                                            [darkMode]="darkModeService.currentSkin === 'dark'"
                                                        >
                                                        </emoji-mart>
                                                    </div>
                                                    <i
                                                        class="mr-1 bi bi-type-bold"
                                                        (click)="boldText()"
                                                        [ngbPopover]="'bold' | localize"
                                                        #CloseEvent="ngbPopover"
                                                        triggers="mouseenter:mouseleave"
                                                    ></i>
                                                    <i
                                                        class="mr-1 bi bi-type-italic"
                                                        (click)="italicText()"
                                                        [ngbPopover]="'italic' | localize"
                                                        #CloseEvent="ngbPopover"
                                                        triggers="mouseenter:mouseleave"
                                                    ></i>

                                                    <i
                                                        class="bi bi-info-circle"
                                                        [ngbPopover]="'templateBodyNote' | localize"
                                                        #CloseEvent="ngbPopover"
                                                        triggers="mouseenter:mouseleave"
                                                    ></i>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row mt-1 text-right" style="float: right">
                                            <button (click)="addVariableOne()" class="btn btn-default w-auto p-0" type="button">
                                                <i class="bi bi-plus"></i>
                                                {{ l("addVariables") }}
                                            </button>

                                            <button (click)="deleteVaribale()" class="btn btn-default w-auto p-0" type="button">
                                                <i class="bi bi-dash"></i>
                                                {{ l("deleteVariables") }}
                                            </button>
                                        </div>
                                    </div>
                                    <div *ngIf="listOfVariables.length > 0" class="input-body">
                                        <div class="d-flex flex-column">
                                            <h3>Sample For body content</h3>
                                            <p>
                                                {{ l("templateBodySample") }}
                                            </p>

                                            <h3>Body</h3>

                                            <div class="col-12 mt-2 p-0">
                                                <div *ngFor="let input of listOfVariables; let index = index">
                                                    <div class="form-group d-flex align-items-baseline my-0">
                                                        <p>{{ '{{' + incrementedIndex(index) + '}}' }}</p>
                                                        <input
                                                            id="bodyForExample"
                                                            name="bodyForExample"
                                                            type="text"
                                                            class="form-control m-1"
                                                            [(ngModel)]="dynamicVariables[index]"
                                                            maxlength="60"
                                                        />
                                                    </div>
                                                    <p class="text-danger" *ngIf="submitted && !dynamicVariables[index]">{{ l("ThisFieldIsRequired") }}</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-12 mt-2 p-0">
                                        <div class="form-group">
                                            <div style="display: flex; flex-direction: row">
                                                <label for="footerText">Footer</label>
                                                <p style="color: #b9b9c3; margin-left: 6px">. Optional</p>
                                            </div>
                                            <div style="display: flex">
                                                <input
                                                    id="footerText"
                                                    name="footerText"
                                                    type="text"
                                                    class="form-control"
                                                    style="position: absolute; padding-right: 53px"
                                                    (input)="handleOnChangeText($event)"
                                                    value="{{ footer }}"
                                                    maxlength="60"
                                                />
                                                <div style="width: 100%; height: 100%; justify-content: flex-end; display: flex; align-items: center; padding: 0.571rem 1rem">
                                                    <p style="z-index: 1; color: #b9b9c3; margin: 0px">{{ footer?.length }}/60</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-12 mt-2 p-0">
                                        <div class="form-group">
                                            <h4 for="buttonType">{{ l("buttonType") }} *</h4>
                                            <p>{{ l("templateButoonDesc") }}</p>

                                            <select
                                                [ngClass]="darkModeService.currentSkin === 'dark' ? 'form-control-dark ' : 'form-control'"
                                                id="buttonType"
                                                name="buttonType"
                                                [(ngModel)]="button.type"
                                                (change)="checkButtonType(button.type)"
                                                required
                                                #buttonName="ngModel"
                                            >
                                                <ng-container *ngFor="let button of buttonTypeEnum">
                                                    <ng-container *ngIf="button.id != 'Opt-out'">
                                                        <option [value]="button.id">
                                                            <span *ngIf="!isArabic">{{ button.nameEn }}</span>
                                                            <span *ngIf="isArabic">{{ button.nameAr }}</span>
                                                        </option>
                                                    </ng-container>
                                                    <ng-container *ngIf="button.id == 'Opt-out' && template.category == 'MARKETING'">
                                                        <option [value]="button.id">
                                                            <span *ngIf="!isArabic">{{ button.nameEn }}</span>
                                                            <span *ngIf="isArabic">{{ button.nameAr }}</span>
                                                        </option>
                                                    </ng-container>
                                                </ng-container>
                                            </select>
                                            <p class="text-danger" *ngIf="submitted && buttonName.invalid">{{ l("ThisFieldIsRequired") }}</p>
                                        </div>
                                    </div>
                                    <div class="col-12 p-0" *ngIf="buttonFlag">
                                        <div class="form-group col-12 p-0 mt-2" *ngIf="textButtonFlag && showFirstButton">
                                            <h4 for="buttonText">{{ l("buttonText") }} *</h4>
                                            <input
                                                name="buttonText"
                                                type="text"
                                                class="form-control"
                                                [(ngModel)]="button.text"
                                                (input)="handleButtonChange($event)"
                                                maxlength="20"
                                                #buttonText="ngModel"
                                                [class.error]="submitted && buttonText.invalid"
                                                required
                                            />
                                            <div class="row text-right">
                                                <span class="text-muted p-0"> 20 {{ l("character") }} </span>
                                            </div>

                                            <p class="text-danger" *ngIf="submitted && buttonText.invalid">{{ l("ThisFieldIsRequired") }}</p>
                                        </div>
                                        <div class="row mt-1" *ngIf="!showSecondButton && textButtonFlag && !phoneButtonFlag && !urlButtonFlag">
                                            <div class="col-12">
                                                <button (click)="createButtonTwo()" class="btn btn-primary-info"><i class="bi bi-plus"></i> {{ l("addButton") }}</button>
                                            </div>
                                        </div>

                                        <div class="form-group col-12 p-0 mt-2" *ngIf="textButtonFlag && showSecondButton">
                                            <h4 for="buttonText">{{ l("buttonText") }} *</h4>
                                            <div class="row d-flex">
                                                <input
                                                    class="button-text form-control"
                                                    name="buttonText"
                                                    type="text"
                                                    [(ngModel)]="buttonTwo.text"
                                                    maxlength="20"
                                                    #buttonText2="ngModel"
                                                    (input)="handleButton2Change($event)"
                                                    [class.error]="submitted && buttonText2.invalid"
                                                    required
                                                />

                                                <button *ngIf="showSecondButton" (click)="deleteButtonTwo()" class="delete btn btn-default-primary">
                                                    <i class="bi bi-x"></i>
                                                </button>
                                            </div>
                                            <div class="row text-right">
                                                <span class="text-muted p-0"> 20 {{ l("character") }} </span>
                                            </div>

                                            <p class="text-danger" *ngIf="submitted && buttonText2.invalid">{{ l("ThisFieldIsRequired") }}</p>
                                        </div>

                                        <div class="form-group col-12 p-0 mt-2" *ngIf="phoneButtonFlag" [formGroup]="phoneForm">
                                            <h4 for="buttonPhone">{{ l("buttonPhone") }} *</h4>
                                            <ngx-intl-tel-input
                                                class="d-contents"
                                                id="countryCode"
                                                [enablePlaceholder]="true"
                                                [searchCountryFlag]="true"
                                                [maxLength]="13"
                                                [selectFirstCountry]="false"
                                                [enableAutoCountrySelect]="true"
                                                [phoneValidation]="true"
                                                [separateDialCode]="false"
                                                [numberFormat]="PhoneNumberFormat.National"
                                                [preferredCountries]="preferredCountries"
                                                [selectedCountryCode]="countryCode"
                                                formControlName="phone"
                                                (change)="checkPhoneNumber()"
                                                required
                                                [class.error]="submitted && !phoneForm.value"
                                            >
                                            </ngx-intl-tel-input>
                                            <p class="text-danger" *ngIf="submitted && !phoneForm.value">{{ l("ThisFieldIsRequired") }}</p>
                                            <p class="text-danger" *ngIf="phoneForm.value && phoneForm.status != 'VALID'">Please Enter Valid Phone Number</p>
                                        </div>

                                        <div class="form-group col-12 p-0 mt-2" *ngIf="urlButtonFlag">
                                            <h4 for="buttonUrl">{{ l("buttonUrl") }} *</h4>
                                            <input
                                                (change)="checkTemplateButtonUrl()"
                                                id="buttonUrl"
                                                name="buttonUrl"
                                                type="text"
                                                class="form-control"
                                                placeholder="https://www.example.com"
                                                [(ngModel)]="button.url"
                                                maxlength="2000"
                                                required
                                                [class.error]="submitted && buttonUrl.invalid"
                                                #buttonUrl="ngModel"
                                            />
                                            <p class="text-danger" *ngIf="submitted && buttonUrl.invalid">{{ l("ThisFieldIsRequired") }}</p>
                                        </div>
                                    </div>

                                    <!-- Opt-Out-button -->
                                    <div class="col-12 p-0" *ngIf="optOutButtonFlag">
                                        <div class="row mt-1" *ngIf="!showSecondButton && textButtonFlag && !phoneButtonFlag && !urlButtonFlag">
                                            <div class="col-12">
                                                <button (click)="createButtonTwo()" class="btn btn-primary-info"><i class="bi bi-plus"></i> {{ l("addButton") }}</button>
                                            </div>
                                        </div>

                                        <div class="form-group col-12 p-0 mt-2" *ngIf="textButtonFlag && showSecondButton">
                                            <h4 for="buttonText">{{ l("buttonText") }} *</h4>
                                            <div class="row d-flex">
                                                <input
                                                    class="button-text form-control"
                                                    name="buttonText"
                                                    type="text"
                                                    [(ngModel)]="buttonTwo.text"
                                                    (input)="handleButton2Change($event)"
                                                    maxlength="20"
                                                    #buttonText2="ngModel"
                                                    [class.error]="submitted && buttonText2.invalid"
                                                    required
                                                />

                                                <button *ngIf="showSecondButton" (click)="deleteButtonTwo()" class="delete btn btn-default-primary">
                                                    <i class="bi bi-x"></i>
                                                </button>
                                            </div>
                                            <div class="row text-right">
                                                <span class="text-muted p-0"> 20 {{ l("character") }} </span>
                                            </div>

                                            <p class="text-danger" *ngIf="submitted && buttonText2.invalid">{{ l("ThisFieldIsRequired") }}</p>
                                        </div>

                                        <div class="form-group col-12 p-0 mt-2" *ngIf="textButtonFlag && showFirstButton">
                                            <h4 for="buttonText">{{ l("buttonOptOut") }} *</h4>
                                            <input
                                                name="buttonText"
                                                type="text"
                                                class="form-control"
                                                [(ngModel)]="predefinedStop"
                                                maxlength="20"
                                                #buttonText="ngModel"
                                                [class.error]="submitted && buttonText.invalid"
                                                required
                                                value="Stop"
                                                disabled="true"
                                            />
                                            <div class="row text-right">
                                                <span class="text-muted p-0"> 20 {{ l("character") }} </span>
                                            </div>

                                            <p class="text-danger" *ngIf="submitted && buttonText.invalid">{{ l("ThisFieldIsRequired") }}</p>
                                        </div>

                                        <div class="form-group col-12 p-0 mt-2" *ngIf="phoneButtonFlag" [formGroup]="phoneForm">
                                            <h4 for="buttonPhone">{{ l("buttonPhone") }} *</h4>
                                            <ngx-intl-tel-input
                                                class="d-contents"
                                                id="countryCode"
                                                [enablePlaceholder]="true"
                                                [searchCountryFlag]="true"
                                                [maxLength]="13"
                                                [selectFirstCountry]="false"
                                                [enableAutoCountrySelect]="true"
                                                [phoneValidation]="true"
                                                [separateDialCode]="false"
                                                [numberFormat]="PhoneNumberFormat.National"
                                                [preferredCountries]="preferredCountries"
                                                [selectedCountryCode]="countryCode"
                                                formControlName="phone"
                                                (change)="checkPhoneNumber()"
                                                required
                                                [class.error]="submitted && !phoneForm.value"
                                            >
                                            </ngx-intl-tel-input>
                                            <p class="text-danger" *ngIf="submitted && !phoneForm.value">{{ l("ThisFieldIsRequired") }}</p>
                                            <p class="text-danger" *ngIf="phoneForm.value && phoneForm.status != 'VALID'">Please Enter Valid Phone Number</p>
                                        </div>

                                        <div class="form-group col-12 p-0 mt-2" *ngIf="urlButtonFlag">
                                            <h4 for="buttonUrl">{{ l("buttonUrl") }} *</h4>
                                            <input
                                                (change)="checkTemplateButtonUrl()"
                                                id="buttonUrl"
                                                name="buttonUrl"
                                                type="text"
                                                class="form-control"
                                                placeholder="https://www.example.com"
                                                [(ngModel)]="button.url"
                                                maxlength="2000"
                                                required
                                                [class.error]="submitted && buttonUrl.invalid"
                                                #buttonUrl="ngModel"
                                            />
                                            <p class="text-danger" *ngIf="submitted && buttonUrl.invalid">{{ l("ThisFieldIsRequired") }}</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="d-flex justify-content-between mt-2" style="padding-bottom: 20px">
                                    <button class="btn btn-outline-primary-info btn-prev" (click)="verticalWizardPrevious()" rippleEffect>
                                        <span class="align-middle d-sm-inline-block"> {{ l("previus") }}</span>
                                    </button>

                                    <button
                                        id="btn"
                                        [buttonBusy]="saving"
                                        [busyText]="l('SavingWithThreeDot')"
                                        class="btn btn-primary-info btn-submit"
                                        rippleEffect
                                        (click)="save()"
                                    >
                                        {{ l("submit") }}
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
