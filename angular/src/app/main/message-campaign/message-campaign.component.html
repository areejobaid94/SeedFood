<div>
    <div class="header-navbar-shadow"></div>
    <div class="content-wrapper container-xxl p-0">
        <div class="content-body">
            <div class="d-flex flex-column flex-column-fluid">
                <sub-header *ngIf="theme != 'theme12'" [title]="'campaign' | localize" [description]="'campaignHeaderInfo'">
                    <div role="actions">
                        <button (click)="createCampaign.show()" class="btn btn-primary blue"><i class="fa fa-plus"></i> {{ l("createCampaign") }}</button>
                        <div class="row mt-1">
                            <div name="" role="form">
                                <button class="btn btn-primary blue">
                                    <i class="fa fa-download"></i>
                                    <a
                                        href="https://infoseedstoragestg.blob.core.windows.net/4408da24-aad7-4802-a1f1-46f5ad9e2074/b98a91c3-23fe-4cbc-9a35-d3a705df07ae.xlsx"
                                        download="proposed_file_name"
                                        style="color: #fff"
                                        >Campaign Prices
                                    </a>
                                </button>
                            </div>
                        </div>
                    </div>
                </sub-header>
                <sub-header *ngIf="theme === 'theme12'" [title]="'campaign' | localize" [description]="'campaignHeaderInfo'"> </sub-header>

                <div [ngClass]="theme != 'theme12' ? 'container' : ''">
                    <div class="card-custom gutter-b card">
                        <div class="card-body">
                            <div style="display: flex; flex-direction: row; align-items: center; padding: 10px; justify-content: space-between" *ngIf="theme === 'theme12'">
                                <div>
                                    <p-tabView (onChange)="switchHeaders($event)" [(activeIndex)]="tabIndex">
                                        <p-tabPanel>
                                            <ng-template pTemplate="header">
                                                <i class="bi bi-person-fill" style="font-size: 20px; margin-right: 10px"></i>
                                                <span>{{ l("groupcampaign") }}</span>
                                            </ng-template>
                                        </p-tabPanel>
                                        <p-tabPanel header="Header II">
                                            <ng-template pTemplate="header">
                                                <i class="bi bi-people-fill" style="font-size: 20px; margin-right: 10px"></i>
                                                <span>{{ l("Individualcampaign") }}</span>
                                            </ng-template>
                                        </p-tabPanel>
                                    </p-tabView>
                                </div>
                                <div style="display: flex; flex-direction: row; margin-left: 30px">
                                    <button (click)="refreshData(type)" class="btn btn-primary-info mr-1">
                                        <i class="fa flaticon-refresh"></i>
                                    </button>
                                    <button class="btn btn-outline-primary-info blue">
                                        <i class="fa fa-download"></i>
                                        <a
                                            class="color-green"
                                            href="assets/static-file/Whatsapp pricing.csv" 
                                            download="WhatsApp Pricing"
                                            >{{ l("WhatsApp Pricing") }}</a
                                        >
                                    </button>
                                    <!-- <button (click)="createCampaign.show()" class="btn btn-outline-primary-info blue"><i class="fa fa-plus"></i> {{ l("createCampaign") }}</button> -->
                                    <button [routerLink]="['/app/main/sendCampaign']" class="btn btn-outline-primary-info blue">
                                        <i class="fa fa-plus"></i>
                                        <a class="color-green">{{ l("createCampaign") }}</a>
                                    </button>
                                </div>
                            </div>
                            <!-- <div class="row p-1">
                                <div
                                class="p-2"
                                    *ngIf="theme != 'theme12'"
                                    [ngClass]="
                                        TotalRemainingAdsConversation <= 100
                                            ? 'alert-box error'
                                            : TotalRemainingAdsConversation > 100 && TotalRemainingAdsConversation <= 500
                                            ? 'alert-box notice'
                                            : TotalRemainingAdsConversation < 500 && TotalRemainingAdsConversation < 1000
                                            ? 'alert-box warning'
                                            : TotalRemainingAdsConversation >= 1000
                                            ? 'alert-box success'
                                            : 'alert-box success'
                                    "
                                >
                                    <span>Note: </span>
                                    <p>Total Out-Bound Conversations ( Remaining ): {{ Measurement.remainingBIConversation }}.</p>
                                    <p>Total Remaining Free conversations: {{ Measurement.remainingFreeConversation }}.</p>
                                    <p>Total = ({{ TotalRemainingAdsConversation }}).</p>
                                </div>
                                <div
                                    *ngIf="theme === 'theme12'"
                                    class="alert col-12 col-xxl-4 col-md-6 p-1"
                                    [ngClass]="
                                        TotalRemainingAdsConversation <= 100
                                            ? 'alert-danger'
                                            : TotalRemainingAdsConversation > 100 && TotalRemainingAdsConversation <= 500
                                            ? 'alert-info'
                                            : TotalRemainingAdsConversation < 500 && TotalRemainingAdsConversation < 1000
                                            ? 'alert-warning'
                                            : TotalRemainingAdsConversation >= 1000
                                            ? 'alert-success'
                                            : 'alert-success'
                                    "
                                >
                                    <span>Note: </span>
                                    <p>Total Out-Bound Conversations ( Remaining ): {{ Measurement.remainingBIConversation }}.</p>
                                    <p>Total Remaining Free conversations: {{ Measurement.remainingFreeConversation }}.</p>
                                    <p>Total = ({{ TotalRemainingAdsConversation }}).</p>
                                </div>
                            </div> -->

                            <div class="align-items-center">
                                <div [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : 'light'" class="primeng-datatable-container">
                                    <p-table
                                        [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : 'light'"
                                        #dataTable
                                        [value]="primengTableHelper.records"
                                        rows="20"
                                        [paginator]="true"
                                        [loading]="primengTableHelper.isLoading"
                                        [lazy]="true"
                                        responsiveLayout="stack"
                                        [breakpoint]="'960px'"
                                        [rowsPerPageOptions]="[20, 100, 5000]"
                                        [resizableColumns]="primengTableHelper.resizableColumns"
                                        [totalRecords]="primengTableHelper.totalRecordsCount"
                                        (onLazyLoad)="getData($event)"
                                    >
                                        <ng-template [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : 'light'" pTemplate="header">
                                            <tr class="table-header">
                                                <!-- <th [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark-table' : ''" style="width: 100px; text-align: center !important;">{{ l("Actions") }}</th> -->

                                                <th
                                                    style="width: 100px; text-align: center !important"
                                                    [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark-table' : ''"
                                                    pSortableColumn="title"
                                                >
                                                    {{ l("campignTitle") }}
                                                </th>
                                                <!-- <th [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark-table' : ''" pSortableColumn="sent" style="width:100px">{{ l("sent") }}</th> -->
                                                <th
                                                    style="width: 120px; text-align: center !important"
                                                    [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark-table' : ''"
                                                    pSortableColumn="status"
                                                >
                                                    {{ l("Status") }}
                                                </th>
                                                <th
                                                    [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark-table' : ''"
                                                    pSortableColumn="sentTime"
                                                    style="width: 180px; text-align: center !important"
                                                >
                                                    {{ l("sentTime") }}
                                                </th>
                                                <!-- <th style="width:100px" [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark-table' : ''" pSortableColumn="sent">{{l('sent')}}</th>
                                                <th style="width:100px" [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark-table' : ''" pSortableColumn="sent">{{l('hanging')}}</th>
                                                <th style="width:100px" [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark-table' : ''" pSortableColumn="delivered">{{ l("deliverd") }}</th>
                                                <th style="width:100px" [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark-table' : ''" pSortableColumn="read">{{ l("read") }}</th>
                                                <th style="width:100px" [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark-table' : ''" pSortableColumn="failed">{{ l("Failed") }}</th>
                                                <th style="width:100px" [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark-table' : ''" pSortableColumn="replied">{{ l("replied") }}</th> -->
                                                <th [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark-table' : ''" style="width: 100px; text-align: center !important">
                                                    {{ l("Agent") }}
                                                </th>
                                                <th [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark-table' : ''" style="width: 100px; text-align: center !important">
                                                    {{ l("Template") }}
                                                </th>
                                                <th [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark-table' : ''" style="width: 100px; text-align: start !important">
                                                    {{ l("Actions") }}
                                                </th>
                                            </tr>
                                        </ng-template>

                                        <ng-template pTemplate="body" let-record="$implicit" let-i="rowIndex">
                                            <tr>
                                                <!-- <td [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : ''" style="width: 100px">
                                                    <div class="btn-group dropdown" dropdown container="body">
                                                        <button *ngIf="theme != 'theme12'" class="dropdown-toggle btn btn-sm btn-primary" style="cursor: pointer" dropdownToggle>
                                                            <i class="fa fa-cog"></i>
                                                            <span class="caret"></span>
                                                        </button>
                                                        <button
                                                            *ngIf="theme === 'theme12'"
                                                            class="dropdown-toggle btn btn-sm btn-primary-info"
                                                            style="cursor: pointer"
                                                            dropdownToggle
                                                        >
                                                            <i class="fa fa-cog"></i>
                                                            <span class="caret"></span>
                                                        </button>

                                                        <ul [ngClass]="darkModeService.currentSkin === 'dark' ? 'drop-down-dark' : ''" class="dropdown-menu" *dropdownMenu>
                                                      
                                                            <li *ngIf="record.status == 1">
                                                                <a href="javascript:;" class="dropdown-item" (click)="generateReport(record.id, record.templateId)">
                                                                    {{ l("generateReport") }}
                                                                </a>
                                                            </li>
                                                            <li *ngIf="record.status != 1">
                                                                <a href="javascript:;" class="dropdown-item" (click)="DeleteCampaign(record)">{{ l("Delete") }}</a>
                                                            </li>
                                                            <li *ngIf="record.status == 2">
                                                                <a href="javascript:;" class="dropdown-item" (click)="cancelScheduledCampaign(record.id)">{{
                                                                    l("cancelScheduling")
                                                                }}</a>
                                                            </li>
                                                            <li>
                                                                <a href="javascript:;" class="dropdown-item" (click)="campaignStatistics.show(record)">{{ l("statistic") }}</a>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </td> -->

                                                <td
                                                    style="width: 100px; text-align: center !important"
                                                    class="custome-title-span"
                                                    [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : ''"
                                                >
                                                    <span class="p-column-title">{{ l("title") }}</span>
                                                    {{ record.title }}
                                                </td>

                                                <td
                                                    style="width: 120px; text-align: center !important"
                                                    *ngIf="theme === 'theme12'"
                                                    [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : ''"
                                                >
                                                    <span class="p-column-title">{{ l("Status") }}</span>

                                                    <span *ngIf="record.status == 0" class="custome-badge custome-badge-draft"> {{ l("draft") }}</span>
                                                    <span *ngIf="record.status == 1" class="custome-badge custome-badge-sent"> {{ l("sent") }}</span>
                                                    <span *ngIf="record.status == 2" class="custome-badge custome-badge-schedual"> {{ l("scheduled") }}</span>
                                                    <span *ngIf="record.status == 3" class="custome-badge custome-badge-active"> {{ l("Active") }}</span>
                                                    <span *ngIf="record.status == 4" class="custome-badge custome-badge-inactive"> {{ l("inActive") }}</span>
                                                </td>

                                                <td
                                                    class="custome-title-span"
                                                    [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : ''"
                                                    style="width: 180px; text-align: center !important"
                                                >
                                                    <span class="p-column-title">{{ l("sentTime") }}</span>
                                                    {{ record.sentTime | date : "dd-MM-yyyy / hh:mm " }}
                                                </td>
                                                <td
                                                    class="custome-title-span"
                                                    [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : ''"
                                                    style="width: 180px; text-align: center !important"
                                                >
                                                    {{ record.userName }}
                                                </td>
                                                <td
                                                    class="custome-title-span"
                                                    [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : ''"
                                                    style="width: 180px; text-align: center !important"
                                                >
                                                    {{ record.templateName }}
                                                </td>
                                                <td
                                                    class="custome-title-span"
                                                    [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : ''"
                                                    style="width: 180px; text-align: start !important"
                                                >
                                                    <div>
                                                        <i
                                                            style="cursor: pointer"
                                                            *ngIf="record.status == 1 || record.status == 2 || record.status == 4"
                                                            class="bi bi-bar-chart custom-chart-icon mr-1"
                                                            [ngbPopover]="getLocalizedText('statistic')"
                                                            (click)="campaignStatistics.show(record)"
                                                            placement="top"
                                                            triggers="mouseenter:mouseleave"
                                                        ></i>
                                                        <!-- <i class="bi bi-clipboard2-data custom-report-icon "
                                                        [ngbPopover]="getLocalizedText('generateReport')"(click)="generateReport(record.id, record.templateId)"
                                                        placement="top"
                                                        triggers="mouseenter:mouseleave"
                                                        ></i> -->
                                                        <i
                                                            style="cursor: pointer"
                                                            *ngIf="record.status == 1 || record.status == 2"
                                                            class="bi bi-download custom-download-icon mr-1"
                                                            [ngbPopover]="getLocalizedText('generateReport')"
                                                            (click)="generateReport(record.id, record.templateId)"
                                                            placement="top"
                                                            triggers="mouseenter:mouseleave"
                                                        ></i>

                                                        <!-- <i style="cursor: pointer;" *ngIf="record.status == 4 || record.status == 2 || record.status == 0 " class="bi bi-trash3 custom-delete-icon  mr-1 "
                                                        [ngbPopover]="getLocalizedText('Delete')"
                                                        (click)="DeleteCampaign(record)"
                                                        placement="top"
                                                        triggers="mouseenter:mouseleave"
                                                        ></i>
                                                        <i  style="cursor: pointer;" *ngIf="record.status == 2" class="bi bi-x-octagon custom-delete-icon "
                                                        [ngbPopover]="getLocalizedText('cancelScheduling')"
                                                        placement="top"
                                                        triggers="mouseenter:mouseleave"
                                                        (click)="cancelScheduledCampaign(record.id)"
                                                        ></i> -->
                                                    </div>
                                                </td>
                                                <!-- <td style="width:100px"  [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : ''">
                                                    <span class="p-column-title">{{l("sent") }}</span>
                                                   
                                                    <div id="chartRefOptions"
                                                    #chartRef>
                                                        <apx-chart
                                                        [chart]="sentChartoptions.chart"
                                                        [grid]="sentChartoptions.grid"
                                                        [colors]="sentChartoptions.colors"
                                                        [series]="[record.sentPercentage]"
                                                        [plotOptions]="sentChartoptions.plotOptions"
                                                        [stroke]="sentChartoptions.stroke"
                                                      ></apx-chart>
                                                       {{record.sentPercentage}} %
                                                </div>
                                                </td>
                                                <td  style="width:100px" [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : ''">
                                                    <span class="p-column-title">{{l("hanging") }}</span>
                                                    <div id="hangingChartoptions"
                                                    #hangedchartRef>
                                                        <apx-chart
                                                        [chart]="hangingChartoptions.chart"
                                                        [grid]="hangingChartoptions.grid"
                                                        [colors]="hangingChartoptions.colors"
                                                        [series]="[record.hangedPercentage]"
                                                        [plotOptions]="hangingChartoptions.plotOptions"
                                                        [stroke]="hangingChartoptions.stroke"
                                                      ></apx-chart>
                                                      {{record.hangedPercentage}} %
                                                </div>
                                                </td>
                                                <td style="width:100px" [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : ''">
                                                    <span class="p-column-title">#{{l("deliverd") }}</span>
                                                    <div id="deliverdChartoptions"
                                                    #deliverdchartRef>
                                                        <apx-chart
                                                        [chart]="deliverdChartoptions.chart"
                                                        [grid]="deliverdChartoptions.grid"
                                                        [colors]="deliverdChartoptions.colors"
                                                        [series]="[record.deliveredPercentage]"
                                                        [plotOptions]="deliverdChartoptions.plotOptions"
                                                        [stroke]="deliverdChartoptions.stroke"
                                                      ></apx-chart>
                                                      {{record.deliveredPercentage}} %
                                                    </div>

                                                </td>
                                                <td style="width:100px" [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : ''">
                                                    <span class="p-column-title">#{{l("read") }}</span>
                                                    <div id="readChartoptions"
                                                    #readchartRef>
                                                        <apx-chart
                                                        [chart]="readChartoptions.chart"
                                                        [grid]="readChartoptions.grid"
                                                        [colors]="readChartoptions.colors"
                                                        [series]="[record.readPercentage]  "
                                                        [plotOptions]="readChartoptions.plotOptions"
                                                        [stroke]="readChartoptions.stroke"
                                                      ></apx-chart>
                                                      {{record.readPercentage}} %
                                                    </div>
                                                </td>
                                                <td style="width:100px" [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : ''">
                                                    <span class="p-column-title">#{{l("Failed") }}</span>
                                                    <div id="failedChartoptions"
                                                    #failedchartRef>
                                                        <apx-chart
                                                        [chart]="failedChartoptions.chart"
                                                        [grid]="failedChartoptions.grid"
                                                        [colors]="failedChartoptions.colors"
                                                        [series]="[record.failedPercentage]  "
                                                        [plotOptions]="failedChartoptions.plotOptions"
                                                        [stroke]="failedChartoptions.stroke"
                                                      ></apx-chart>
                                                      {{record.failedPercentage}} %
                                                    </div>
                                                </td>
                                                <td style="width:100px" [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : ''">
                                                    <span class="p-column-title">#{{l("replied") }}</span>
                                                    <div id="repliedChartoptions"
                                                    #repliedchartRef>
                                                        <apx-chart
                                                        [chart]="repliedChartoptions.chart"
                                                        [grid]="repliedChartoptions.grid"
                                                        [colors]="repliedChartoptions.colors"
                                                        [series]="[record.repliedPercentage]"
                                                        [plotOptions]="repliedChartoptions.plotOptions"
                                                        [stroke]="repliedChartoptions.stroke"
                                                      ></apx-chart>
                                                      {{record.repliedPercentage}} %
                                                    </div>
                                                </td> -->
                                            </tr>
                                        </ng-template>
                                    </p-table>

                                    <div class="primeng-no-data" *ngIf="primengTableHelper.totalRecordsCount == 0">
                                        {{ l("NoData") }}
                                    </div>
                                    <div class="primeng-paging-container">
                                        <!-- <p-paginator
                                            [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark' : ''"
                                            (onPageChange)="ngOnInit($event)"
                                            [rows]="20"
                                            #paginator
                                            [totalRecords]="primengTableHelper.totalRecordsCount"
                                            [rowsPerPageOptions]="[20, 100, 5000]"
                                        >
                                        </p-paginator> -->
                                        <span class="total-records-count">
                                            {{ l("TotalRecordsCount", primengTableHelper.totalRecordsCount) }}
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <AddMessageCampaign #AddMessageCampaign (modalSave)="ngOnInit()"></AddMessageCampaign>
                <!-- <ViewCampaignHistory #ViewCampaignHistory (modalSave)="ngOnInit()"></ViewCampaignHistory> -->
                <createCampaign #createCampaign (modalSave)="ngOnInit()"></createCampaign>
                <campaignStatistics #campaignStatistics></campaignStatistics>
            </div>
        </div>
    </div>
</div>
