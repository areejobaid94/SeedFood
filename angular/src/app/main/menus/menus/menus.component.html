<div [@routerTransition]>
    <div class="header-navbar-shadow" ></div>
    <div class="content-wrapper container-xxl p-0">
        <div class="content-body">
            <div class="d-flex flex-column flex-column-fluid">
                <sub-header *ngIf="theme != 'theme12'" [title]="'menus' | localize" [description]="'menuHeaderInfo' | localize"> </sub-header>
                <sub-header *ngIf="theme === 'theme12'" [title]="'menus' | localize" [description]="'menuHeaderInfo' | localize"> </sub-header>
                <!-- <p>
                    Customer needs to buy from your whatsapp store to earn points and redeem them from your Menu.
                    <a  (click)="viewVideo.show(videoLink)" ><u> Learn How Loyalty program Work.  <i class="bi bi-play-circle"></i></u></a>
                </p> -->
                <div class="row p-3" *ngIf="theme != 'theme12'">
                    <div class="col-md-6">
                        <div class="row">
                            <div class="col-12 col-xl-6" *ngIf="isAdmin">
                                <label>{{l("logoImage")}}</label>
                                <input accept=".jpg, .jpeg, .png, .gif" type="file" #file class="form-control" (change)="onFileChange1($event, modalBasic)" />
                                <div class="product-img">
                                    <img class="logoImage" alt="Menu Image"  [src]="imagSrc" />
                                </div>
                            </div>

                            <div class="col-12 col-xl-6" *ngIf="!isAdmin">
                                <label>{{l("logoImage")}}</label>
                                <input accept=".jpg, .jpeg, .png, .gif" disabled type="file" id="uplode1" class="form-control" (change)="onFileChange1($event, modalBasic)" />
                                <div class="product-img">
                                    <img class="logoImage" alt="Menu Image" [src]="imagSrc" />
                                </div>
                            </div>

                            <div class="col-12 col-xl-6" *ngIf="isAdmin">
                                <label>{{l("bgImage")}}</label>
                                <input accept=".jpg, .jpeg, .png, .gif" type="file"  #file2 id="uplode2" class="form-control" (change)="onFileChange2($event, modalBasic2)" />
                                <div class="product-img">
                                    <img class="logoImage" alt="Menu Image" [src]="imagBGSrc" />
                                </div>
                            </div>

                            <div class="col-12 col-xl-6" *ngIf="!isAdmin">
                                <label>{{l("bgImage")}}</label>
                                <input accept=".jpg, .jpeg, .png, .gif" disabled type="file" id="uplode2" class="form-control" (change)="onFileChange2($event, modalBasic2)" />
                                <div class="product-img">
                                    <img class="logoImage" alt="Menu Image" [src]="imagBGSrc" />
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 text-right">
                        <div class="dropdown form-group breadcrum-right">
                            <button
                                id="dropdownMenuButton1"
                                data-bs-toggle="dropdown"
                                aria-expanded="false"
                                type="button"
                                rippleeffect=""
                                class="dropdown-toggle btn-icon btn btn-primary btn-round btn-sm waves-effect waves-float waves-light"
                                aria-expanded="false"
                            >
                                <svg
                                    xmlns="http://www.w3.org/2000/svg"
                                    width="14"
                                    height="14"
                                    viewBox="0 0 24 24"
                                    fill="none"
                                    stroke="currentColor"
                                    stroke-width="2"
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                    class="feather feather-grid"
                                >
                                    <rect x="3" y="3" width="7" height="7"></rect>
                                    <rect x="14" y="3" width="7" height="7"></rect>
                                    <rect x="14" y="14" width="7" height="7"></rect>
                                    <rect x="3" y="14" width="7" height="7"></rect>
                                </svg>
                            </button>
                            <div
                                class="dropdown-menu"
                                aria-labelledby="dropdownMenuButton1"
                                ngbdropdownmenu=""
                                x-placement="bottom-left"
                            >
                                <a (click)="createAdvancedMenuu()" class="dropdown-item"> <i class="fa fa-plus"></i>{{ l("createAdvMenu") }}</a>

                                <a (click)="createMenu()" class="dropdown-item">
                                    <i class="fa fa-plus p-0 font-12"></i>
                                    {{ l("createMenu") }}</a
                                >

                                <a routerLink="/app/main/CreateAddOns" class="dropdown-item">
                                    <i class="fa fa-plus p-0 font-12"></i>
                                    {{ l("createAddOns") }}</a
                                >
                                <a routerLink="/app/main/CreateOptions" class="dropdown-item">
                                    <i class="fa fa-plus p-0 font-12"></i>
                                    {{ l("createOptions") }}</a
                                >
                            </div>
                        </div>
                    </div>
                </div>

                <div [ngClass]="theme != 'theme12' ? 'container' : ''">
                    <div class="card card-custom gutter-b">
                        <div class="card-body" [ngClass]="theme != 'theme12' ? 'p-0' : ''">
                            <div class="row mb-2 m-2" *ngIf="theme === 'theme12'">
                                <div *ngIf="isAdmin" class="col-12  content-header-right d-md-block" [ngClass]="isArabic? 'text-left' : 'text-right'">
                                    <div class="dropdown form-group breadcrum-right">
                                        <button
                                            id="dropdownMenuButton1"
                                            data-bs-toggle="dropdown"
                                            aria-expanded="false"
                                            type="button"
                                            rippleeffect=""
                                            [ngClass]="theme != 'theme12' ? 'btn-primary' : 'btn-primary-info'"
                                            class="dropdown-toggle btn-icon btn btn-round btn-sm waves-effect waves-float waves-light"
                                            aria-expanded="false"
                                        >
                                            <svg
                                                xmlns="http://www.w3.org/2000/svg"
                                                width="14"
                                                height="14"
                                                viewBox="0 0 24 24"
                                                fill="none"
                                                stroke="currentColor"
                                                stroke-width="2"
                                                stroke-linecap="round"
                                                stroke-linejoin="round"
                                                class="feather feather-grid"
                                            >
                                                <rect x="3" y="3" width="7" height="7"></rect>
                                                <rect x="14" y="3" width="7" height="7"></rect>
                                                <rect x="14" y="14" width="7" height="7"></rect>
                                                <rect x="3" y="14" width="7" height="7"></rect>
                                            </svg>
                                        </button>
                                        <div
                                            class="dropdown-menu"
                                            aria-labelledby="dropdownMenuButton1"
                                            ngbdropdownmenu=""
                                            x-placement="bottom-left"
                                         
                                        >
                                            <a (click)="createAdvancedMenuu()" class="dropdown-item"> <i class="fa fa-plus"></i>{{ l("createAdvMenu") }}</a>

                                            <a (click)="createMenuu()" class="dropdown-item">
                                                <i class="fa fa-plus p-0 font-12"></i>
                                                {{ l("createMenu") }}</a
                                            >

                                            <a routerLink="/app/main/CreateAddOns" class="dropdown-item">
                                                <i class="fa fa-plus p-0 font-12"></i>
                                                {{ l("createAddOns") }}</a
                                            >
                                            <a routerLink="/app/main/CreateOptions" class="dropdown-item">
                                                <i class="fa fa-plus p-0 font-12"></i>
                                                {{ l("createOptions") }}</a
                                            >
                                        </div>
                                    </div>
                                </div>
                                <div class="col" *ngIf="isAdmin">
                                    <label>{{l("logoImage")}}</label>
                                    <input
                                        accept=".jpg, .jpeg, .png, .gif"
                                        type="file"
                                        #file
                                       class="form-control"
                                        (change)="onFileChange1($event, modalBasic)"
                                    />
                                    <div  *ngIf="imagSrc && !loadLogoImage " class="product-img mt-1 text-center">
                                        <img class="logoImage" alt="Menu Image" [src]="imagSrc" height="104" width="150" />
                                    </div>
                                    <div *ngIf="loadLogoImage " class="row justify-content-center mt-1">
                                        <div class="spinner-border text-danger " role="status">
                                       <span class="sr-only">Loading...</span>
                                   </div>
                                   </div>
                                </div>

                                <div class="col" *ngIf="!isAdmin">
                                    <label>{{l("logoImage")}}</label>
                                    <input
                                        accept=".jpg, .jpeg, .png, .gif"
                                        disabled
                                        type="file"
                                        id="uplode1"
                                        
                                       class="form-control"
                                        (change)="onFileChange1($event, modalBasic)"
                                    />
                                    <div class="product-img text-center mt-1">
                                        <img class="logoImage" alt="Menu Image" [src]="imagSrc" height="104" width="150" />
                                    </div>
                                </div>

                                <div class="col" *ngIf="isAdmin">
                                    <label>{{l("bgImage")}}</label>
                                    <input
                                        accept=".jpg, .jpeg, .png, .gif"
                                        type="file"
                                        #file2
                                       class="form-control"
                                        (change)="onFileChange2($event, modalBasic2)"
                                    />
                                    <div   *ngIf="imagSrc && !loadBgImage " class="product-img text-center mt-1">
                                        <img class="logoImage" alt="Menu Image" [src]="imagBGSrc" height="104" width="150" />
                                    </div>
                                    <div *ngIf="loadBgImage " class="row justify-content-center mt-1">
                                        <div class="spinner-border text-danger " role="status">
                                       <span class="sr-only">Loading...</span>
                                   </div>
                                   </div>
                                </div>

                                <div class="col" *ngIf="!isAdmin">
                                    <label>{{l("bgImage")}}</label>
                                    <input
                                        accept=".jpg, .jpeg, .png, .gif"
                                        disabled
                                        type="file"
                                       
                                        class="form-control"
                                        (change)="onFileChange2($event, modalBasic2)"
                                    />
                                    <div class="product-img text-center mt-1">
                                        <img class="logoImage" alt="Menu Image" [src]="imagBGSrc" height="104" width="150" />
                                        <!-- <button disabled class="mt-1 ml-auto mr-auto d-block btn btn-primary-info" (click)="openFileUploder2()">Replace</button> -->
                                    </div>
                                </div>
                            </div>
                            <div class="align-items-center">
                                <!--<Primeng-Datatable-Start>-->
                                <div
                                    class="form-control"
                                    [busyIf]="primengTableHelper.isLoading"
                                    class="primeng-datatable-container"
                                    [busyIf]="primengTableHelper.isLoading"
                                >
                                    <p-table
                                        [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : 'light'"
                                        #dataTable
                                        (onLazyLoad)="getMenus($event)"
                                        [value]="primengTableHelper.records"
                                        rows="20"
                                        [paginator]="false"
                                        [lazy]="true"
                                        responsiveLayout="stack"
                                        [breakpoint]="'960px'"
                                        [resizableColumns]="primengTableHelper.resizableColumns"
                                    >
                                        <ng-template [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : 'light'" pTemplate="header">
                                            <tr>
                                                <th [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark-table' : ''" style="width: 80px">{{ l("Actions") }}</th>

                                                <th
                                                    [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark-table' : ''"
                                                    style="width: 150px; font-family: system-ui"
                                                    pSortableColumn="menuName"
                                                >
                                                    {{ l("menuNameAr") }}
                                                    <p-sortIcon field="menu.menuName"></p-sortIcon>
                                                </th>
                                                <th
                                                    [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark-table' : ''"
                                                    style="width: 150px; font-family: system-ui"
                                                    pSortableColumn="menuNameEnglish"
                                                >
                                                    {{ l("menuNameEn") }}
                                                    <p-sortIcon field="menu.menuNameEnglish"></p-sortIcon>
                                                </th>

                                                <th
                                                    [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark-table' : ''"
                                                    style="width: 80px; font-family: system-ui"
                                                    pSortableColumn="priority"
                                                >
                                                    {{ l("priority") }}
                                                    <p-sortIcon field="menu.priority"></p-sortIcon>
                                                </th>
                                            </tr>
                                        </ng-template>
                                        <ng-template pTemplate="body" let-record="$implicit" let-i="rowIndex">
                                            <tr>
                                                <td [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : ''" style="width: 80px">
                                                    <div class="btn-group dropdown" dropdown container="body">
                                                        <button
                                                            [ngClass]="theme != 'theme12' ? 'btn-primary' : 'btn-primary-info'"
                                                            class="dropdown-toggle btn btn-sm"
                                                            dropdownToggle
                                                        >
                                                            <i class="fa fa-cog"></i><span class="caret"></span>
                                                        </button>
                                                        <ul [ngClass]="darkModeService.currentSkin === 'dark' ? 'drop-down-dark' : ''" class="dropdown-menu" *dropdownMenu>
                                                            <li *ngIf="record.menuTypeId === regularMenu">
                                                                <a
                                                                    *ngIf="theme != 'theme12'"
                                                                    href="javascript:;"
                                                                    class="dropdown-item"
                                                                    (click)="createOrEditMenuModal.show(record.id)"
                                                                    >{{ l("Edit") }}</a
                                                                >
                                                                <a *ngIf="theme === 'theme12'" href="javascript:;" class="dropdown-item" (click)="editMenu(record.id)">{{
                                                                    l("Edit")
                                                                }}</a>
                                                            </li>
                                                            <li *ngIf="record.menuTypeId === advanceMenu">
                                                                <a *ngIf="theme != 'theme12'" href="javascript:;" class="dropdown-item" (click)="editAdvancedMenu(record)">{{
                                                                    l("Edit")
                                                                }}</a>
                                                                <a *ngIf="theme === 'theme12'" href="javascript:;" class="dropdown-item" (click)="editAdvancedMenu(record)">{{
                                                                    l("Edit")
                                                                }}</a>
                                                            </li>
                                                            <li>
                                                                <a href="javascript:;" class="dropdown-item" (click)="viewMenuModal.show(record)">{{ l("editAddOns") }}</a>
                                                            </li>
                                                            <li>
                                                                <a href="javascript:;" class="dropdown-item" (click)="viewItemSpecificationsModal.show(record)">{{
                                                                    l("editOptions")
                                                                }}</a>
                                                            </li>
                                                            <li *ngIf="isAdmin">
                                                                <a class="dropdown-item" href="javascript:;" (click)="deleteMenu(record)">{{ l("Delete") }}</a>
                                                            </li>

                                                            <li *ngIf="isAdmin">
                                                                <a class="dropdown-item" href="javascript:;" (click)="createOrEditMenuSettingModel.show(record.id)">{{
                                                                    l("Settings")
                                                                }}</a>
                                                            </li>
                                                            <li *ngIf="record.menuTypeId === advanceMenu">
                                                                <a
                                                                    href=""
                                                                    class="dropdown-item"
                                                                    [routerLink]="['/app/main/ManageAdvancedMenu/ManageAdvancedMenu']"
                                                                    [queryParams]="{ menuid: record.id }"
                                                                    >{{ l("manageMenu") }}</a
                                                                >
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </td>
                                                <td [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : ''" style="width: 150px">
                                                    <span class="p-column-title"> {{ l("menuNameAr") }}</span>
                                                    {{ record.menuName }}
                                                </td>
                                                <td [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : ''" style="width: 150px">
                                                    <span class="p-column-title"> {{ l("menuNameEn") }}</span>
                                                    {{ record.menuNameEnglish }}
                                                </td>

                                                <td [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : ''" style="width: 80px">
                                                    <span class="p-column-title"> {{ l("priority") }}</span>
                                                    {{ record.priority }}
                                                </td>
                                            </tr>
                                        </ng-template>
                                    </p-table>
                                    <div class="primeng-no-data" *ngIf="primengTableHelper.totalRecordsCount == 0">
                                        {{ l("NoData") }}
                                    </div>
                                    <div class="primeng-paging-container">
                                        <p-paginator
                                            [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark' : ''"
                                            [rows]="20"
                                            #paginator
                                            (onPageChange)="getMenus($event)"
                                            [totalRecords]="primengTableHelper.totalRecordsCount"
                                            [rowsPerPageOptions]="[10,20,30]"
                                        >
                                        </p-paginator>
                                        <span class="total-records-count">
                                            {{ l("TotalRecordsCount", primengTableHelper.totalRecordsCount) }}
                                        </span>
                                    </div>
                                </div>
                                <!--<Primeng-Datatable-End>-->
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- <createOrEditSpecificationModal #createOrEditSpecificationModal (modalSave)="getMenus()"></createOrEditSpecificationModal> -->
                <!-- <createOrEditAddModal #createOrEditAddModal (modalSave)="getMenus()"></createOrEditAddModal> -->
                <!-- <createOrEditMenuModal #createOrEditMenuModal (modalSave)="getMenus()"></createOrEditMenuModal>
                <createOrEditAdvancedMenuModal #createOrEditAdvancedMenuModal (modalSave)="getMenus()"></createOrEditAdvancedMenuModal> -->

                <createOrEditMenuSettingModel (modalSave)="getMenus()" #createOrEditMenuSettingModel></createOrEditMenuSettingModel> 
                <viewMenuModal #viewMenuModal (modalSave)="getMenus()" (returnRtype)="handleRtypeFromchild($event)" [rtypeFromPerant]="Rtype"></viewMenuModal>
                <viewItemSpecificationsModal #viewItemSpecificationsModal (returnRtype)="handleRtypeFromchild($event)" [rtypeFromPerant]="Rtype"></viewItemSpecificationsModal>
            </div>
        </div>
    </div>
</div>

<ng-template #modalBasic let-modal>
    <div class="modal-header">
        <h4 class="modal-title" id="myModalLabel1">{{ l("imageCropper") }}</h4>
    </div>
    <div class="modal-body" tabindex="0" ngbAutofocus>
        <image-cropper
            [imageChangedEvent]="imageChangedEvent"
            [maintainAspectRatio]="true"
            [cropperStaticWidth]="500"
            [cropperStaticHeight]="500"
            [aspectRatio]="1"
            [onlyScaleDown]="true"
            (imageCropped)="imageCroppedFile($event)"
        ></image-cropper>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-default" (click)="modal.dismiss('Cross click')" rippleEffect>{{ l("Cancel") }}</button>
        <button type="button" class="btn btn-primary-info" (click)="saveImage(); modal.close('Accept click')" rippleEffect>{{ l("accept") }}</button>
    </div>
</ng-template>

<ng-template #modalBasic2 let-modal>
    <div class="modal-header">
        <h4 class="modal-title" id="myModalLabel1">{{ l("imageCropper") }}</h4>
    </div>
    <div class="modal-body" tabindex="0" ngbAutofocus>
        <image-cropper
            [imageChangedEvent]="imageChangedEvent"
            [cropperStaticWidth]="980"
            [cropperStaticHeight]="300" 
            [onlyScaleDown]="true"
            [maintainAspectRatio]="true"
            [aspectRatio]="1"
            (imageCropped)="imageCroppedFile2($event)"
        ></image-cropper>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-default" (click)="modal.dismiss('Cross click')" rippleEffect>{{ l("Cancel") }}</button>
        <button type="button" class="btn btn-primary-info" (click)="saveImage2(); modal.close('Accept click')" rippleEffect>{{ l("accept") }}</button>
    </div> 
</ng-template>
<viewVideo #viewVideo ></viewVideo>

