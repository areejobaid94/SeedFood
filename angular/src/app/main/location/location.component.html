<div [@routerTransition]>
    <div class="header-navbar-shadow"></div>
    <div class="content-wrapper container-xxl p-0">
        <div class="content-body">
            <div class="d-flex flex-column flex-column-fluid">
                <sub-header *ngIf="theme != 'theme12'" [title]="'location' | localize" [description]="'locationHeaderInfo' | localize">
                    <div role="actions">
                        <button (click)="createLocation()" class="btn btn-primary btn-round btn-sm waves-effect waves-float waves-light">
                            <i class="fa fa-plus"></i>{{ l("addLocation") }}
                        </button>
                    </div>
                </sub-header>
                <sub-header *ngIf="theme === 'theme12'" [title]="'location' | localize" [description]="'locationHeaderInfo' | localize"> </sub-header>

                <div [ngClass]="theme != 'theme12' ? 'container' : ''">
                    <div class="card-custom gutter-b card">
                        <div class="card-body">
                            <div class="row" [hidden]="theme != 'theme12'">
                                <div class="col-md-6 col-12 text-right"></div>
                                <div class="col-md-6 col-12 p-1" [ngClass]="isArabic? 'text-left' : 'text-right'">
                                    <button (click)="createLocation()" class="btn btn-outline-primary-info mr-1"><i class="fa fa-plus"></i> {{ l("addLocation") }}</button>
                                </div>
                            </div>

                            <div class="row m-1" *ngIf="theme != 'theme12'">
                                <div class="col-md-6">
                                    <label>{{ l("country") }}:</label>
                                    <select 
                                        (change)="onChangeCountry($event)" 
                                        [(ngModel)]="countryId"
                                        [ngClass]="darkModeService.currentSkin === 'dark' ? 'form-control-dark ' : 'form-control'">
                                        <option *ngFor="let count of country" [value]="count.locationId">{{ count.locationName }}</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label>{{ l("city") }}:</label>
                                    <select 
                                        (change)="onChangeCity($event)" 
                                        [(ngModel)]="cityId"
                                        [ngClass]="darkModeService.currentSkin === 'dark' ? 'form-control-dark ' : 'form-control'">
                                        <option *ngFor="let city of cities" [value]="city.locationId">{{ city.locationName }}</option>
                                    </select>
                                </div>
                                <div class="col-md-6 p-0">
                                      <label>{{ l("area") }}:</label>
                                      <div class="mb-1 input-group d-flex justify-content-md-end">
                                      
                                        <select
                                        [(ngModel)]="areaId"
                                        [ngClass]="darkModeService.currentSkin === 'dark' ? 'form-control-dark ' : 'form-control'">
                                        <option  [value]="null"></option>
                                        <option *ngFor="let area of areas" [value]="area.locationId">{{ area.locationName }}</option>
                                    </select>
                                        <button (click)="getLocations($event)" class="btn btn-primary" type="submit"><i
                                                class="flaticon-search-1"></i></button>
                                    </div>
                                    
                                </div>
                            </div>

                            <div class="row mb-1 p-1" [hidden]="theme != 'theme12'">

                                <div class="col-md-6">
                                    <label>{{ l("country") }}:</label>
                                    <select
                                        (change)="onChangeCountry($event)"
                                        [(ngModel)]="countryId"
                                        [ngClass]="darkModeService.currentSkin === 'dark' ? 'form-control-dark ' : 'form-control'">
                                        <option *ngFor="let count of country" [value]="count.locationId">{{ count.locationName }}</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label>{{ l("city") }}:</label>
                                    <select
                                        (change)="onChangeCity($event)"
                                        [(ngModel)]="cityId"
                                        [ngClass]="darkModeService.currentSkin === 'dark' ? 'form-control-dark ' : 'form-control'">
                                        <option *ngFor="let city of cities" [value]="city.locationId">{{ city.locationName }}</option>
                                    </select>
                                </div>
                                <div class="col-md-6 col-12 p-0"> 
                                    <label class="ml-xl-1 ml-md-1 pr-1 pb-1 pl-1 pl-md-0 pb-md-0">{{ l("area") }}:</label>
                                    <div class="d-flex ml-xl-1 ml-md-1 align-items-center pr-1 pb-1 pl-1 pl-md-0 pb-md-0">
                                        <select
                                            [(ngModel)]="areaId"
                                            [ngClass]="darkModeService.currentSkin === 'dark' ? 'form-control-dark ' : 'form-control'">
                                            <option  [value]="null"></option>
                                            <option *ngFor="let area of areas" [value]="area.locationId">{{ area.locationName }}</option>
                                        </select>
                                        <button class="btn btn-primary-info" (click)="getLocations($event)" type="button"><i class="flaticon-search-1"></i></button>
                                    </div>
                                </div>
                            </div>
                            <div class="row align-items-center">
                                <!--<Primeng-Datatable-Start>-->
                                <div
                                    class="primeng-datatable-container p-0"
                                    [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : 'light'"
                                    [busyIf]="primengTableHelper.isLoading"
                                >
                                    <p-table
                                        #dataTable
                                        [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : 'light'"
                                        (onLazyLoad)="getLocations($event)"
                                        class="table-responsive"
                                        [value]="primengTableHelper.records"
                                        rows="100"
                                        [paginator]="false"
                                        [lazy]="true"
                                        responsiveLayout="stack"
                                        [breakpoint]="'960px'"
                                        [resizableColumns]="primengTableHelper.resizableColumns"
                                    >
                                        <ng-template pTemplate="header">
                                            <tr>
                                                <th [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark-table' : ''" style="width: 50px">{{ l("Actions") }}</th>
                                                <th [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark-table' : ''" style="width: 100px" pSortableColumn="cityName">
                                                    {{ l("city") }}
                                                    <p-sortIcon field="cityName"></p-sortIcon>
                                                </th>
                                                <th [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark-table' : ''" style="width: 100px" pSortableColumn="areaName">
                                                    {{ l("area") }}
                                                    <p-sortIcon field="areaName"></p-sortIcon>
                                                </th>
                                                <th [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark-table' : ''" style="width: 100px" pSortableColumn="districtName">
                                                    {{ l("district") }}
                                                    <p-sortIcon field="districtName"></p-sortIcon>
                                                </th>

                                                <th [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark-table' : ''" style="width: 100px" pSortableColumn="deliveryCost">
                                                    {{ l("deliveryCost") }}
                                                    <p-sortIcon field="deliveryCost"></p-sortIcon>
                                                </th>
                                                <th [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark-table' : ''" style="width: 120px" pSortableColumn="branchAreaId">
                                                    {{ l("assignToBranch") }}
                                                    <p-sortIcon field="branchAreaId"></p-sortIcon>
                                                </th>
                                                <th [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark-table' : ''" style="width: 100px" pSortableColumn="isAvailable">
                                                    {{ l("isAvailable") }}
                                                    <p-sortIcon field="isAvailable"></p-sortIcon>
                                                </th>
                                            </tr>
                                        </ng-template>
                                        <ng-template
                                            [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : 'light'"
                                            pTemplate="body"
                                            let-record="$implicit"
                                            let-i="rowIndex"
                                        >
                                            <tr>
                                                <td [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : ''" style="width: 50px">
                                                    <div class="btn-group dropdown" dropdown container="body">
                                                        <button
                                                            [ngClass]="theme != 'theme12' ? 'btn-primary' : 'btn-primary-info'"
                                                            class="dropdown-toggle btn btn-sm"
                                                            dropdownToggle
                                                        >
                                                            <i class="fa fa-cog"></i><span class="caret"></span>
                                                        </button>

                                                        <ul [ngClass]="darkModeService.currentSkin === 'dark' ? 'drop-down-dark' : ''" class="dropdown-menu" *dropdownMenu>
                                                            <li>
                                                                <a href="javascript:;" class="dropdown-item" (click)="editLocation(record)">{{ l("Edit") }}</a>
                                                            </li>   
                                                            <!-- <li>
                                                                <a href="javascript:;" class="dropdown-item" (click)="deleteLocation(record)">{{ l("Delete") }}</a>
                                                            </li> -->
                                                        </ul>
                                                    </div>
                                                </td>
                                                <td  (click)="editLocation(record)" [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : ''" style="font-family: system-ui; width: 100px">
                                                    <span class="p-column-title"> {{ l("city") }}</span>
                                                    {{ record.cityName }}
                                                </td>

                                                <td  (click)="editLocation(record)" [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : ''" style="font-family: system-ui; width: 100px">
                                                    <span class="p-column-title"> {{ l("area") }}</span>
                                                    {{ record.areaName }}
                                                </td>

                                                <td  [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : ''" style="font-family: system-ui; width: 100px">
                                                    <span class="p-column-title"> {{ l("district") }}</span>
                                                    <a href="{{ record.googleURL }}" target="_blank">{{ record.locationName }}</a>
                                                </td>

                                                <td  (click)="editLocation(record)" [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : ''" style="font-family: system-ui; width: 100px">
                                                    <span class="p-column-title"> {{ l("deliveryCost") }}</span>
                                                    {{ record.deliveryCost }} <small>{{ currency }}</small>
                                                </td>

                                                <td  (click)="editLocation(record)" [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : ''" style="font-family: system-ui; width: 120px">
                                                    <span class="p-column-title"> {{ l("assignToBranch") }}</span>
                                                    {{ record.branchAreaRes }} {{ record.branchAreaCor }}
                                                </td>
                                                <td  (click)="editLocation(record)" [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : ''" style="font-family: system-ui; width: 100px">
                                                    <span class="p-column-title"> {{ l("isAvaiable") }}</span>
                                                    <span *ngIf="record.isAvailable == 1"><i class="fa fa-check-circle text-success" title="True"></i></span>
                                                    <span *ngIf="record.isAvailable == 0"><i class="fa fa-times-circle" title="False"></i></span>
                                                </td>
                                            </tr>
                                        </ng-template>
                                    </p-table>
                                    <div class="primeng-no-data" *ngIf="primengTableHelper.totalRecordsCount == 0">
                                        {{ l("NoData") }}
                                    </div>
                                    <div class="primeng-paging-container">
                                        <p-paginator
                                            [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark' : ''"
                                            [rows]="100"
                                            #paginator
                                            (onPageChange)="getLocations($event)"
                                            [totalRecords]="primengTableHelper.totalRecordsCount"
                                            [rowsPerPageOptions]="[100,400,1000]"
                                        >
                                        </p-paginator>
                                        <span class="total-records-count">
                                            {{ l("TotalRecordsCount", primengTableHelper.totalRecordsCount) }}
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <createOrEditLocationModal #createOrEditLocationModal (modalSave)="deleteFilters();getLocations($event,true)"></createOrEditLocationModal>
            </div>
        </div>
    </div>
</div>
