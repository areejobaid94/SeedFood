<div>
    <div class="header-navbar-shadow"></div>
    <div class="content-wrapper container-xxl p-0">
        <div class="content-body">
            <div class="d-flex flex-column flex-column-fluid">
                <sub-header *ngIf="theme != 'theme12'" [title]="'billings' |
                    localize" [description]="'BillingsHeaderInfo' | localize">
                </sub-header>
                <sub-header *ngIf="theme === 'theme12'" [title]="'billings' |
                    localize" [description]="'billingsHeaderInfo' | localize">
                </sub-header>
                <div [ngClass]="theme != 'theme12' ? 'container' : ''">
                    <div class="card-custom gutter-b card">
                        <div class="card-body" [ngClass]="theme != 'theme12' ?
                            'p-0' : ''">
                            <div class="row mb-2">
                                <!-- <div class="mt-1 d-flex col-12 col-xl-6">
                                    <select
                                        [ngClass]="darkModeService.currentSkin
                                        === 'dark' ? 'form-control-dark ' :
                                        'form-control'"
                                        name="FilterStatements"
                                        class="ml-xl-1 ml-md-1 w-50"
                                        [(ngModel)]="FilterStatements"
                                        (change)="onChangeStatements($event)"
                                        id="FilterStatements">
                                        <option value="null" disabled
                                            style="font-family: system-ui;
                                            font-size: 20px">Choose Period</option>
                                        <option value="today"
                                            style="font-family: system-ui;
                                            font-size: 20px">Today</option>
                                        <option value="this_week"
                                            style="font-family: system-ui;
                                            font-size: 20px">this week</option>
                                        <option value="this_month"
                                            style="font-family: system-ui;
                                            font-size: 20px">this month</option>
                                        <option value="this_year"
                                            style="font-family: system-ui;
                                            font-size: 20px">this year</option>
                                        <option value="yesterday"
                                            style="font-family: system-ui;
                                            font-size: 20px">yesterday</option>
                                        <option value="previous_week"
                                            style="font-family: system-ui;
                                            font-size: 20px">previous week</option>
                                        <option value="previous_month"
                                            style="font-family: system-ui;
                                            font-size: 20px">previous month</option>
                                        <option value="previous_quarter"
                                            style="font-family: system-ui;
                                            font-size: 20px">previous quarter</option>
                                    </select>
                                </div> -->

                                <!-- <div class="col-xl-6 col-12 mt-1 p-0
                                    text-right">
                                    <button (click)="DownLoadStatements()"
                                        [ngClass]="theme != 'theme12' ?
                                        'btn-outline-primary' :
                                        'btn-outline-primary-info'"
                                        class="btn
                                        mr-1"><i
                                            class="fa fa-file-pdf"></i>
                                        {{l('DownLoad Statements')}}</button>
                                </div> -->
                                <!-- <div class="col-xl-6 col-12 mt-1 p-0
                                text-right">
                                <button (click)="Sync()"
                                    [ngClass]="theme != 'theme12' ?
                                    'btn-outline-primary' :
                                    'btn-outline-primary-info'"
                                    class="btn
                                    mr-1"><i
                                        class="fa fa-file-pdf"></i>
                                    {{l('Zoho Sync')}}</button>
                            </div> -->
                            </div>
                            <div class="align-items-center">
                                <!--<Primeng-Datatable-Start>-->
                                <div
                                    [ngClass]="darkModeService.currentSkin ===
                                    'dark' ? 'table-dark' : 'light'"
                                    class="primeng-datatable-container "
                                    [loading]="primengTableHelper.isLoading"
                                >
                                    <p-table
                                    [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : 'light'"
                                    (onLazyLoad)="getBillings($event)" class="table-responsive "
                                    [value]="primengTableHelper.records"
                                    rows="20" [paginator]="false"
                                    [lazy]="true" [scrollable]="true" 
                                    [responsive]="primengTableHelper.isResponsive"
                                    [resizableColumns]="primengTableHelper.resizableColumns"  >
                                        <ng-template pTemplate="header"
                                            [ngClass]="darkModeService.currentSkin
                                            === 'dark' ? 'table-dark' :
                                            'light'">
                                            <tr>
                                                <th
                                                    [ngClass]="darkModeService.currentSkin
                                                    === 'dark' ? 'dark-table' :
                                                    ''" style="width: 80px"
                                                    [hidden]="!isGrantedAny('Pages.Billings.Edit',
                                                    'Pages.Billings.Delete')">{{
                                                    l("Actions") }}
                                                </th>
                                                <th
                                                    [ngClass]="darkModeService.currentSkin
                                                    === 'dark' ? 'dark-table' :
                                                    ''" style="width: 150px"
                                                    pSortableColumn="currencyFk.currencyName">
                                                    {{l('invoice')}} #
                                                    <p-sortIcon field="invoice
                                                        number"></p-sortIcon>
                                                </th>
                                                <th
                                                    [ngClass]="darkModeService.currentSkin
                                                    === 'dark' ? 'dark-table' :
                                                    ''" style="width: 120px"
                                                    pSortableColumn="billingID">
                                                    {{l('customer')}}
                                                    <p-sortIcon
                                                        field="billing.billingID"></p-sortIcon>
                                                </th>
                                                <th
                                                    [ngClass]="darkModeService.currentSkin
                                                    === 'dark' ? 'dark-table' :
                                                    ''" style="width: 100px"
                                                    pSortableColumn="status">
                                                    {{l('Status')}}
                                                    <p-sortIcon
                                                        field="billing.status"></p-sortIcon>
                                                </th>
                                                <th
                                                    [ngClass]="darkModeService.currentSkin
                                                    === 'dark' ? 'dark-table' :
                                                    ''" style="width: 100px"
                                                    pSortableColumn="date">
                                                    {{l('Status')}}
                                                    <p-sortIcon
                                                        field="billing.date"></p-sortIcon>
                                                </th>
                                                <th
                                                    [ngClass]="darkModeService.currentSkin
                                                    === 'dark' ? 'dark-table' :
                                                    ''" style="width: 100px"
                                                    pSortableColumn="due_date">
                                                    {{l('dueDate')}}
                                                    <p-sortIcon
                                                        field="billing.due_date"></p-sortIcon>
                                                </th>
                                                <th
                                                    [ngClass]="darkModeService.currentSkin
                                                    === 'dark' ? 'dark-table' :
                                                    ''" style="width: 170px"
                                                    pSortableColumn="totalAmount">
                                                    {{l('TotalAmount')}}
                                                    <p-sortIcon
                                                        field="billing.total"></p-sortIcon>
                                                </th>

                                                <!-- <th style="width: 150px" pSortableColumn="isPayed">
                                        Status
                                        <p-sortIcon field="billing.isPayed"></p-sortIcon>
                                    </th> -->
                                                <!-- <th style="width: 150px" pSortableColumn="dueDate">
                                        {{l('DueDate')}}
                                        <p-sortIcon field="billing.dueDate"></p-sortIcon>
                                    </th> -->
                                            </tr>
                                        </ng-template>

                                        <ng-template pTemplate="body"
                                            let-record="$implicit"
                                            let-i="rowIndex">
                                            <tr>
                                                <td
                                                    [ngClass]="darkModeService.currentSkin
                                                    === 'dark' ?
                                                    'table-dark' : ''"
                                                    style="width: 80px"
                                                    [hidden]="!isGrantedAny('Pages.Billings.Edit',
                                                    'Pages.Billings.Delete')">
                                                    <div class="btn-group
                                                        dropdown" dropdown
                                                        container="body">
                                                        <button [ngClass]="theme
                                                            != 'theme12' ?
                                                            'btn-primary' :
                                                            'btn-primary-info'"
                                                            class="dropdown-toggle
                                                            btn btn-sm "
                                                            style="cursor:
                                                            pointer"
                                                            dropdownToggle>
                                                            <i class="fa
                                                                fa-cog"></i>
                                                            <span class="caret"></span>
                                                        </button>

                                                        <ul
                                                            [ngClass]="darkModeService.currentSkin
                                                            === 'dark' ?
                                                            'drop-down-dark' :
                                                            ''"
                                                            class="dropdown-menu"
                                                            *dropdownMenu>
                                                            <li>
                                                                <a
                                                                    href="{{record.invoice_url}}"
                                                                    [ngClass]="record.status
                                                                    === 'paid' ?
                                                                    'disabled' :
                                                                    ''"
                                                                    class="dropdown-item"
                                                                    target="_blank">{{l('pay')}}</a>
                                                            </li>
                                                            <li>
                                                                <a
                                                                    class="dropdown-item"
                                                                    (click)="viewBillingModal.show(record)">{{
                                                                    l("view") }}</a>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </td>

                                                <td
                                                    (click)="viewBillingModal.show(record)"
                                                    [ngClass]="darkModeService.currentSkin
                                                    === 'dark' ?
                                                    'table-dark' : ''"
                                                    style="
                                                    width: 150px">
                                                    <span
                                                        class="p-column-title">
                                                        {{l('invoice')}} #</span>
                                                    {{record.invoice_number}}
                                                </td>
                                                <td
                                                    (click)="viewBillingModal.show(record)"
                                                    [ngClass]="darkModeService.currentSkin
                                                    === 'dark' ?
                                                    'table-dark' : ''"
                                                    style="
                                                    width: 120px">
                                                    <span
                                                        class="p-column-title">
                                                        {{l('customer')}}</span>
                                                    {{record.customer_name}}
                                                </td>
                                                <!-- <td
                                                    [ngClass]="darkModeService.currentSkin
                                                    === 'dark' ?
                                                    'table-dark' : ''"
                                                    style=" cursor: pointer;
                                                    width: 100px">
                                                    <span
                                                        class="p-column-title">
                                                        {{l('status')}}</span>
                                                    {{record.status}}
                                                </td> -->
                                                <td
                                                    (click)="viewBillingModal.show(record)"
                                                    [ngClass]="darkModeService.currentSkin
                                                    === 'dark' ?
                                                    'table-dark' : ''"
                                                    style="
                                                    width: 100px">
                                                    <span
                                                        class="p-column-title">
                                                        {{l('Status')}}
                                                    </span>
                                                    <span *ngIf="record.status
                                                        == 'sent'"
                                                        [ngClass]="theme !=
                                                        'theme12' ?
                                                        'badge-danger' :
                                                        'badge-light-danger'"
                                                        class="w-100 badge
                                                        badge-pill ">
                                                        sent
                                                    </span>

                                                    <span *ngIf="record.status
                                                        == 'draft'"
                                                        [ngClass]="theme !=
                                                        'theme12' ?
                                                        'badge-secondary' :
                                                        'badge-light-secondary'"
                                                        class="w-100 badge
                                                        badge-pill">
                                                        draft
                                                    </span>
                                                    <span *ngIf="record.status
                                                        == 'paid'"
                                                        [ngClass]="theme !=
                                                        'theme12' ?
                                                        'badge-success' :
                                                        'badge-light-success'"
                                                        class="w-100 badge
                                                        badge-pill ">
                                                        Paid
                                                    </span>
                                                    <span *ngIf="record.status
                                                        == 'overdue'"
                                                        [ngClass]="theme !=
                                                        'theme12' ?
                                                        'badge-danger' :
                                                        'badge-light-danger'"
                                                        class="w-100 badge
                                                        badge-pill ">
                                                        overdue
                                                    </span>
                                                </td>

                                                <td
                                                    (click)="viewBillingModal.show(record)"
                                                    [ngClass]="darkModeService.currentSkin
                                                    === 'dark' ?
                                                    'table-dark' : ''"
                                                    style="
                                                    width: 100px">
                                                    <span
                                                        class="p-column-title">
                                                        {{l('date')}}</span>
                                                    <span *ngIf="record.date">
                                                        {{record.date |
                                                        momentFormat:'L' }}
                                                    </span>
                                                    <span *ngIf="!record.date">-</span>
                                                </td>
                                                <td
                                                    (click)="viewBillingModal.show(record)"
                                                    [ngClass]="darkModeService.currentSkin
                                                    === 'dark' ?
                                                    'table-dark' : ''"
                                                    style="
                                                    width: 100px">
                                                    <span
                                                        class="p-column-title">
                                                        {{l('dueDate')}}</span>
                                                    <span
                                                        *ngIf="record.due_date">
                                                        {{record.due_date |
                                                        momentFormat:'L' }}
                                                    </span>
                                                    <span
                                                        *ngIf="!record.due_date">-</span>
                                                </td>
                                                <td style="width:100px"
                                                    (click)="viewBillingModal.show(record)"
                                                    [ngClass]="darkModeService.currentSkin
                                                    === 'dark' ?
                                                    'table-dark' : ''">
                                                    <span
                                                        class="p-column-title">
                                                        {{l('TotalAmount')}}</span>
                                                    {{record.total}}
                                                </td>
                                                <!-- <td  style="width:150px">
										<span class="p-column-title"> Status </span>

                                        <button *ngIf="record.billing.isPayed" class="btn btn-success" style="pointer-events: none;font-size: medium; color: #ffffff; background-color: #00ba36; border-color: #1BC5BD;width: 100px;">Paid </button>
                                        <button *ngIf="!record.billing.isPayed" class="btn btn-danger" style="pointer-events: none;font-size: medium;width: 100px; ">Not Paid</button>

                                    </td> -->
                                            </tr>
                                        </ng-template>
                                    </p-table>

                                    <div class="primeng-no-data"
                                        *ngIf="primengTableHelper.totalRecordsCount
                                        == 0">
                                        {{ l("NoData") }}
                                    </div>
                                    <div class="primeng-paging-container">
                                        <p-paginator
                                            [ngClass]="darkModeService.currentSkin
                                            === 'dark' ? 'dark' : ''"
                                            (onPageChange)="getBillings($event)"
                                            [rows]="20"
                                            #paginator
                                            [totalRecords]="primengTableHelper.totalRecordsCount"
                                            [rowsPerPageOptions]="[10,20,30]">
                                        </p-paginator>
                                        <span class="total-records-count">
                                            {{ l("TotalRecordsCount",
                                            primengTableHelper.totalRecordsCount)
                                            }}
                                        </span>
                                    </div>
                                </div>


                            </div>
                        </div>
                    </div>
                </div>
                <!-- <viewAssetsModal #ViewAssetsComponent></viewAssetsModal> -->
                <!-- <createOrEditBillingModal #createOrEditBillingModal (modalSave)="getBillings()"></createOrEditBillingModal>     -->
                <viewBillingModal #viewBillingModal></viewBillingModal>
            </div>
        </div>
    </div>
</div>
<div hidden id="sampleTable" bsModal #createOrEditModal="bs-modal" class="modal
    fade" tabindex="-1" role="dialog"
    aria-labelledby="createOrEditModal" aria-hidden="true" [config]="{backdrop:
    'static'}">
    <div class="modal-dialog modal-lg p-3">
        <div class="modal-content">
            <div [innerHtml]="printData"></div>
        </div>
    </div>
