<div [@routerTransition]>
    <div class="header-navbar-shadow"></div>
    <div class="content-wrapper container-xxl p-0">
        <div class="content-body">
            <div class="d-flex flex-column flex-column-fluid">
                <sub-header *ngIf="theme != 'theme12'" [title]="'Evaluation' | localize" [description]="'Evaluation Header Info' | localize">
                    <div role="actions" *ngIf="isAdmin">
                        <button (click)="exportToExcel()" class="mt-2 btn btn-primary btn-round btn-sm waves-effect waves-float waves-light">
                            <i class="fa fa-file-excel"></i> {{ l("ExportToExcel") }}
                        </button>

                        <!-- <button  (click)="createBranch()"
                                          class="btn btn-primary blue"><i class="fa fa-plus"></i> {{l("Create New Branch")}}</button> -->

                        <button (click)="deleteAllEvaluation()" class="mt-2 btn btn-primary btn-round btn-sm waves-effect waves-float waves-light">
                            <i class="fa fa-trash p-0 font-12"></i> {{ l("deleteAllEvaluation") }}
                        </button>
                    </div>
                </sub-header>
                <sub-header *ngIf="theme === 'theme12'" [title]="'evaluation' | localize" [description]="'evaluationHeaderInfo' | localize"> </sub-header>

                <div [ngClass]="theme != 'theme12' ? 'container' : ''">
                    <div class="card-custom gutter-b card">
                        <div class="card-body" [ngClass]="theme != 'theme12' ? 'p-0' : ''">
                            <div class="row mb-2" *ngIf="theme === 'theme12'">
                                <div *ngIf="isAdmin" class="p-1 col-12 content-header-right d-md-block d-none" [ngClass]="isArabic? 'text-left' : 'text-right'">
                                    <div class="dropdown form-group breadcrum-right">
                                            <button
                                            [ngClass]="theme != 'theme12' ? 'btn-primary' : 'btn-primary-info'" 
                                            id="dropdownMenuButton1" 
                                             data-bs-toggle="dropdown" 
                                             aria-expanded="false"
                                                type="button"
                                                rippleeffect=""
                                                class="dropdown-toggle btn-icon btn  btn-round btn-sm waves-effect waves-float waves-light"
                                            >
                                                <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    width="14"
                                                    height="14"
                                                    viewBox="0 0 24 24"
                                                    fill="none"
                                                    stroke="currentColor"
                                                    stroke-width="2"
                                                    stroke-linecap="round"
                                                    stroke-linejoin="round"
                                                    class="feather feather-grid"
                                                >
                                                    <rect x="3" y="3" width="7" height="7"></rect>
                                                    <rect x="14" y="3" width="7" height="7"></rect>
                                                    <rect x="14" y="14" width="7" height="7"></rect>
                                                    <rect x="3" y="14" width="7" height="7"></rect>
                                                </svg>
                                            </button>
                                            <div
                                            class="dropdown-menu" aria-labelledby="dropdownMenuButton1"
                                                x-placement="bottom-left"
                                              
                                            >
                                                <a  (click)="exportToExcel()" class="dropdown-item" 
                                                    >   <i class="fa fa-file-excel"></i>
                                                    {{ l("ExportToExcel") }}</a
                                                ><a  (click)="deleteAllEvaluation()"  class="dropdown-item" 
                                                    >
                                                    <i class="fa fa-trash p-0 font-12"></i> 
                                                    {{ l("deleteAllEvaluation") }}</a
                                                >
                                              
                                            </div>
                                      
                                    </div>
                                </div>
                            </div>
                            <div class=" align-items-center">
                                <!--<Primeng-Datatable-Start>-->
                                <div class="primeng-datatable-container "
                                [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : 'light'" [busyIf]="primengTableHelper.isLoading">
                                    <p-table
                                    [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : 'light'"

                                        #dataTable
                                        (onLazyLoad)="getEvaluation($event)"
                                        [value]="primengTableHelper.records"
                                        rows="20"
                                        [paginator]="false"
                                        [lazy]="true"
                                        [scrollable]="true"
                                        ScrollWidth="100%"
                                        [responsive]="primengTableHelper.isResponsive"
                                        [resizableColumns]="primengTableHelper.resizableColumns"
                                    >
                                        <ng-template pTemplate="header">
                                            <tr>
                                                <th  [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark-table' : ''" *ngIf="isAdmin" style="width: 100px">{{ l("Actions") }}</th>
                                                <th  [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark-table' : ''" style="width: 150px" pSortableColumn="orderNumber">
                                                    {{ l("orders") }} #
                                                    <p-sortIcon field="orderNumber"></p-sortIcon>
                                                </th>
                                                <th  [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark-table' : ''" style="width: 150px" pSortableColumn="contactName">
                                                    {{ l("customer") }}
                                                    <p-sortIcon field="contactName"></p-sortIcon>
                                                </th>
                                                <th  [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark-table' : ''" *ngIf="isAdmin" style="min-width: 160px" pSortableColumn="phoneNumber">
                                                    {{ l("phoneNumber") }}
                                                    <p-sortIcon field="phoneNumber"></p-sortIcon>
                                                </th>

                                                <th  [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark-table' : ''" style="width: 150px" pSortableColumn="evaluationsText">
                                                    {{ l("evaluation") }}
                                                    <p-sortIcon field="evaluationsText"></p-sortIcon>
                                                </th>
                                                <th  [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark-table' : ''" style="width: 200px" pSortableColumn="evaluationsReat">
                                                    {{ l("evaluationRate") }}
                                                    <p-sortIcon field="evaluationsReat"></p-sortIcon>
                                                </th>
                                                <th  [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark-table' : ''" style="width: 150px" pSortableColumn="creatDate">
                                                    {{ l("Date") }}
                                                    <p-sortIcon field="creatDate"></p-sortIcon>
                                                </th>
                                                <th  [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark-table' : ''" style="width: 150px" pSortableColumn="creatTime">
                                                    {{ l("Time") }}
                                                    <p-sortIcon field="creatTime"></p-sortIcon>
                                                </th>
                                            </tr>
                                        </ng-template>
                                        <ng-template pTemplate="body" let-record="$implicit" let-i="rowIndex">
                                            <tr>
                                                <td [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : ''" style="width: 100px">
                                                    <div class="btn-group dropdown" dropdown container="body">
                                                        <button [ngClass]="theme != 'theme12' ? 'btn-primary' : 'btn-primary-info'"  class="dropdown-toggle btn btn-sm " dropdownToggle>
                                                            <i class="fa fa-cog"></i><span class="caret"></span>
                                                        </button>
                                                        <ul [ngClass]="darkModeService.currentSkin === 'dark' ? 'drop-down-dark' : ''" class="dropdown-menu" *dropdownMenu>
                                                            <!-- <li>
                                                        <a href="javascript:;" class="dropdown-item"
                                                            (click)="viewEvaluationModal.show(record)">{{l('View')}}</a>
                                                    </li>
                                                    <li>
                                                    <a href="javascript:;"  class="dropdown-item"
                                                            (click)="createOrEditEvaluationModal.show(record.area.id)">{{l('Edit')}}</a>
                                                    </li> -->

                                                            <li *ngIf="theme != 'theme12'">
                                                                <a
                                                                    class="dropdown-item"
                                                                    [routerLink]="['/app/main/teamInbox/teamInbox12']"
                                                                    [queryParams]="{ CustomerID: record.userId }"
                                                                    > {{ l("chat") }}</a
                                                                >
                                                            </li>
                                                            <li *ngIf="theme === 'theme12'">
                                                                <a
                                                                    class="dropdown-item"
                                                                    [routerLink]="['/app/main/teamInbox/teamInbox12']"
                                                                    [queryParams]="{ CustomerID: record.userId }"
                                                                    > {{ l("chat") }}</a
                                                                >
                                                            </li>

                                                            <li *ngIf="isAdmin">
                                                                <a class="dropdown-item" href="javascript:;" (click)="deleteEvaluation(record.evaluation)">{{ l("Delete") }}</a>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </td>
                                                <td [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : ''" style="width: 150px">
                                                    <span class="p-column-title"> {{ l("orders") }} #</span>
                                                    {{ record.evaluation.orderNumber }}
                                                </td>

                                                <td [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : ''" style=" width: 150px">
                                                    <span class="p-column-title"> {{ l("customer") }}</span>
                                                    {{ record.evaluation.contactName }}
                                                </td>
                                                <td [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : ''" *ngIf="isAdmin" style=" width: 150px">
                                                    <span class="p-column-title"> {{ l("phoneNumber") }}</span>
                                                    {{ record.evaluation.phoneNumber }}
                                                </td>

                                                <td [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : ''"
                                                    style=" width: 150px"
                                                    *ngIf="record.evaluation.evaluationsText.includes('http') && record.evaluation.evaluationsText.startsWith('http')"
                                                >
                                                    <span class="p-column-title"> {{ l("evaluation") }}</span>

                                                    <a href="{{ record.evaluation.evaluationsText }}" target="_blank">[File]</a>
                                                </td>
                                                <td [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : ''"
                                                    style="width: 150px"
                                                    *ngIf="record.evaluation.evaluationsText.includes('http') && !record.evaluation.evaluationsText.startsWith('http')"
                                                >
                                                    <span class="p-column-title"> {{ l("Evaluation") }}</span>

                                                    <a href="{{ record.evaluation.evaluationsText }}" target="_blank">[File]</a>
                                                </td>

                                                <td  [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : ''" style="width: 150px" *ngIf="!record.evaluation.evaluationsText.includes('http')">
                                                    <span class="p-column-title"> {{ l("evaluation") }}</span>
                                                    {{ record.evaluation.evaluationsText }}
                                                </td>
                                                <td [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : ''" style="width: 200px">
                                                    <span class="p-column-title"> {{ l("evaluationRate") }}</span>
                                                    {{ record.evaluation.evaluationsReat }}
                                                </td>

                                                <td [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : ''" style=" width: 150px">
                                                    <span class="p-column-title"> {{ l("Date") }}</span>
                                                    {{ record.creatDate | date : "shortDate"}}
                                                </td>
                                                <td [ngClass]="darkModeService.currentSkin === 'dark' ? 'table-dark' : ''" style="width: 150px">
                                                    <span class="p-column-title"> {{ l("Time") }}</span>
                                                    {{ record.creatTime }}
                                                </td>
                                            </tr>
                                        </ng-template>
                                    </p-table>
                                    <div class="primeng-no-data" *ngIf="primengTableHelper.totalRecordsCount == 0">
                                        {{ l("NoData") }}
                                    </div>
                                    <div class="primeng-paging-container">
                                        <p-paginator [ngClass]="darkModeService.currentSkin === 'dark' ? 'dark' : ''"
                                            [rows]="20"
                                            #paginator
                                            (onPageChange)="getEvaluation($event)"
                                            [totalRecords]="primengTableHelper.totalRecordsCount"
                                            [rowsPerPageOptions]="[10,20,30]"
                                        >
                                        </p-paginator>
                                        <span class="total-records-count">
                                            {{ l("TotalRecordsCount", primengTableHelper.totalRecordsCount) }}
                                        </span>
                                    </div>
                                </div>
                                <!--<Primeng-Datatable-End>-->
                            </div>
                        </div>
                    </div>
                </div>
                <!-- <createOrEditEvaluationModal #createOrEditEvaluationModal (modalSave)="getEvaluation()"></createOrEditEvaluationModal>
      <viewEvaluationModal #viewEvaluationModal></viewEvaluationModal> -->
            </div>
        </div>
    </div>
</div>
